<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:18px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="cd64"></a><span style=" font-family:'Ubuntu'; font-size:xx-large; font-weight:600;">К</span><span style=" font-family:'Ubuntu'; font-size:xx-large; font-weight:600;">ак писать Bash-однострочники для клонирования и управления GitHub/GitLab репозиториями</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image2024888226.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://medium.com/@morningita?source=post_page-----53ca1d421177----------------------"><span style=" font-family:'Ubuntu'; text-decoration: underline; color:#0000ff;">Olga Sayfudinova</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://medium.com/nuances-of-programming/как-писать-bash-однострочники-для-клонирования-и-управления-github-gitlab-репозиториями-53ca1d421177?source=post_page-----53ca1d421177----------------------"><span style=" font-family:'Ubuntu'; text-decoration: underline; color:#0000ff;">Sep 16</span></a><span style=" font-family:'Ubuntu';"> · 6 min read</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Ubuntu';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image2061006242.png" /><img src="image1245828128.png" /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;"><a name="11a0"></a><span style=" font-family:'Ubuntu';">М</span><span style=" font-family:'Ubuntu';">ало что радует так же сильно, как одна красивая Bash-строка, способная автоматизировать часы рутинной работы.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="731e"></a><span style=" font-family:'Ubuntu';">Я</span><span style=" font-family:'Ubuntu';"> изучала вопрос по автоматическому восстановлению системы на ноутбуке с помощью Bash-скриптов и искала простой способ клонирования GitHub-репозиториев на новую машину. Немного покопавшись в коде, мне удалось написать однострочник, который смог все это реализовать.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="38eb"></a><span style=" font-family:'Ubuntu';">З</span><span style=" font-family:'Ubuntu';">атем, чтобы, так сказать, отделить мух от котлет, я написала еще один однострочник для автоматического создания и отправки резервных копий на GitLab. Привожу эти полезные команды.</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="0491"></a><span style=" font-family:'Ubuntu'; font-size:x-large; font-weight:600;">К</span><span style=" font-family:'Ubuntu'; font-size:x-large; font-weight:600;">лонирование всех GitHub-репозиториев</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="748a"></a><span style=" font-family:'Ubuntu';">П</span><span style=" font-family:'Ubuntu';">ояснение: вам нужен список GitHub-репозиториев для клонирования. Самое классное здесь то, что вы можете выделять только нужные вам репозитории, а не копировать все без разбора.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="91dd"></a><span style=" font-family:'Ubuntu';">Ч</span><span style=" font-family:'Ubuntu';">тобы клонировать GitHub-репозитории и не вводить каждый раз пароли, вам пригодится HTTPS с </span><a href="https://help.github.com/en/articles/caching-your-github-password-in-git"><span style=" font-family:'Ubuntu'; text-decoration: underline; color:#0000ff;">15-минутным кэшированием учетных данных</span></a><span style=" font-family:'Ubuntu';"> или мой любимый метод — </span><a href="https://help.github.com/en/articles/connecting-to-github-with-ssh"><span style=" font-family:'Ubuntu'; text-decoration: underline; color:#0000ff;">подключение к GitHub через SSH</span></a><span style=" font-family:'Ubuntu';">. Для краткости мы воспользуемся вторым способом с уже настроенными SSH-ключами.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="8699"></a><span style=" font-family:'Ubuntu';">Н</span><span style=" font-family:'Ubuntu';">апример, вот в файле </span><span style=" font-family:'Courier New,courier';">gh-repos.txt</span><span style=" font-family:'Ubuntu';"> у нас есть такой список GitHub-адресов:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="2be5"></a><span style=" font-family:'Courier New,courier';">g</span><span style=" font-family:'Courier New,courier';">it@github.com:username/first-repository.git<br />git@github.com:username/second-repository.git<br />git@github.com:username/third-repository.git</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="297f"></a><span style=" font-family:'Ubuntu';">В</span><span style=" font-family:'Ubuntu';">ыполняем следующую команду:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="0ae2"></a><span style=" font-family:'Courier New,courier'; font-weight:600;">x</span><span style=" font-family:'Courier New,courier'; font-weight:600;">args</span><span style=" font-family:'Courier New,courier';"> -n1 </span><span style=" font-family:'Courier New,courier'; font-weight:600;">git </span><span style=" font-family:'Courier New,courier';">clone </span><span style=" font-family:'Courier New,courier'; font-weight:600;">&lt;</span><span style=" font-family:'Courier New,courier';"> gh-repos.txt</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="e14c"></a><span style=" font-family:'Ubuntu';">О</span><span style=" font-family:'Ubuntu';">на клонирует все репозитории из списка в текущую папку. Если правильно указать URL, то этот же одностраничник будет работать и для GitLab.</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="4247"></a><span style=" font-family:'Ubuntu'; font-size:x-large; font-weight:600;">К</span><span style=" font-family:'Ubuntu'; font-size:x-large; font-weight:600;">ак это работает?</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="6297"></a><span style=" font-family:'Ubuntu';">Д</span><span style=" font-family:'Ubuntu';">анный однострочник состоит из двух частей. Справа, как ни странно, расположены входные значения, а слева — та часть, которая в принципе и делает всю работу. Чтобы сделать эту команду еще более понятной, можно записать ее в следующем виде:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="dd08"></a><span style=" font-family:'Courier New,courier';">&lt;</span><span style=" font-family:'Courier New,courier';">gh-repos.txt </span><span style=" font-family:'Courier New,courier'; font-weight:600;">xargs </span><span style=" font-family:'Courier New,courier';">-n1 </span><span style=" font-family:'Courier New,courier'; font-weight:600;">git</span><span style=" font-family:'Courier New,courier';"> clone</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="7115"></a><span style=" font-family:'Ubuntu';">Ч</span><span style=" font-family:'Ubuntu';">тобы выполнить команду для каждой строки входных значений из </span><span style=" font-family:'Courier New,courier';">gh-repos.txt</span><span style=" font-family:'Ubuntu';">, мы воспользуемся </span><span style=" font-family:'Courier New,courier';">xargs -n1</span><span style=" font-family:'Ubuntu';">. Инструмент </span><span style=" font-family:'Courier New,courier';">xargs</span><span style=" font-family:'Ubuntu';"> считывает элементы из входных значений и выполняет все найденные команды (либо возвращает </span><span style=" font-family:'Courier New,courier';">echo</span><span style=" font-family:'Ubuntu';">, если ничего не найдено). По умолчанию элементы разделяются пробелами. Можно добавить новые строки, благодаря чему список легче читается. Флажок </span><span style=" font-family:'Courier New,courier';">-n1</span><span style=" font-family:'Ubuntu';"> предписывает </span><span style=" font-family:'Courier New,courier';">xargs</span><span style=" font-family:'Ubuntu';"> воспользоваться </span><span style=" font-family:'Courier New,courier';">1</span><span style=" font-family:'Ubuntu';"> аргументом, либо, как в нашем случае, одной строкой на команду. Эта команда создается через </span><span style=" font-family:'Courier New,courier';">git clone</span><span style=" font-family:'Ubuntu';">, который </span><span style=" font-family:'Courier New,courier';">xargs</span><span style=" font-family:'Ubuntu';"> затем выполнит для каждой строки. Вот и все.</span></p>
<p style=" margin-top:18px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="ff72"></a><span style=" font-family:'Ubuntu'; font-size:xx-large; font-weight:600;">С</span><span style=" font-family:'Ubuntu'; font-size:xx-large; font-weight:600;">оздание и отправка нескольких репозиториев на GitLab</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="cb13"></a><span style=" font-family:'Ubuntu';">В</span><span style=" font-family:'Ubuntu';"> отличие от GitHub, для создания нового репозитория на GitLab нам не нужно будет открывать сайт. </span><a href="https://gitlab.com/help/gitlab-basics/create-project#push-to-create-a-new-project"><span style=" font-family:'Ubuntu'; text-decoration: underline; color:#0000ff;">Создавать новый GitLab-репозиторий можно напрямую из терминала</span></a><span style=" font-family:'Ubuntu';">. Этому новому репозиторию автоматически присваивается статус </span><span style=" font-family:'Courier New,courier';">Private</span><span style=" font-family:'Ubuntu';">, так что если вы хотите выложить репозиторий в открытый доступ, то придется делать это вручную немного позже.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="cd74"></a><span style=" font-family:'Ubuntu';">В</span><span style=" font-family:'Ubuntu';"> документации по GitLab нам советуют создавать новый проект через </span><span style=" font-family:'Courier New,courier';">git push — set-upstream</span><span style=" font-family:'Ubuntu';">. Однако лично мне эта команда кажется неудобной для создания резервных GitLab-копий. Я планирую работать со своими репозиториями в будущем. Поэтому мне нужна одна команда, которая смогла бы отправлять GitHub </span><span style=" font-family:'Ubuntu'; font-style:italic;">и</span><span style=" font-family:'Ubuntu';"> GitLab изменения на сервер без особых усилий с моей стороны.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="821c"></a><span style=" font-family:'Ubuntu';">Д</span><span style=" font-family:'Ubuntu';">ля корректной работы Bash-однострочника нужен список с адресами GitLab-репозиториев (которые пока что не существуют). Тут есть простое решение: можно скопировать список GitHub-репозиториев, открыть его в Vim и выполнить </span><a href="https://vim.fandom.com/wiki/Search_and_replace"><span style=" font-family:'Ubuntu'; text-decoration: underline; color:#0000ff;">поиск с заменой</span></a><span style=" font-family:'Ubuntu';">:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="b728"></a><span style=" font-family:'Courier New,courier'; font-weight:600;">c</span><span style=" font-family:'Courier New,courier'; font-weight:600;">p</span><span style=" font-family:'Courier New,courier';"> gh-repos.txt gl-repos.txt<br /></span><span style=" font-family:'Courier New,courier'; font-weight:600;">vim</span><span style=" font-family:'Courier New,courier';"> gl-repos.txt<br />:%s/\&lt;github\&gt;/gitlab/g<br />:wq</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="16bd"></a><span style=" font-family:'Ubuntu';">Т</span><span style=" font-family:'Ubuntu';">ак мы получили следующий файл </span><span style=" font-family:'Courier New,courier';">gl-repos.txt</span><span style=" font-family:'Ubuntu';">:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="4062"></a><span style=" font-family:'Courier New,courier';">g</span><span style=" font-family:'Courier New,courier';">it@gitlab.com:username/first-repository.git<br />git@gitlab.com:username/second-repository.git<br />git@gitlab.com:username/third-repository.git</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="971d"></a><span style=" font-family:'Ubuntu';">М</span><span style=" font-family:'Ubuntu';">ожно создать эти репозитории на GitLab, добавить URL-адреса в качестве удаленных репозиториев, а затем отправить код в новые репозитории. Это делается по следующей команде:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="3e7b"></a><span style=" font-family:'Courier New,courier'; font-weight:600;">a</span><span style=" font-family:'Courier New,courier'; font-weight:600;">wk </span><span style=" font-family:'Courier New,courier';">-F’\/|(\.git)’ ‘{system(“cd ~/FULL/PATH/” </span><span style=" font-family:'Courier New,courier'; font-weight:600;">$2</span><span style=" font-family:'Courier New,courier';"> “ &amp;&amp; git remote set-url origin — add “ </span><span style=" font-family:'Courier New,courier'; font-weight:600;">$0</span><span style=" font-family:'Courier New,courier';"> “ &amp;&amp; git push”)}’ gl-repos.txt</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="f4b3"></a><span style=" font-family:'Ubuntu';">Н</span><span style=" font-family:'Ubuntu';">емного терпения — я все объясню. Пока что вам нужно запомнить следующее: </span><span style=" font-family:'Courier New,courier';">~/FULL/PATH/</span><span style=" font-family:'Ubuntu';"> — это полный путь к директории с вашими GitHub-репозиториями.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="b688"></a><span style=" font-family:'Ubuntu';">О</span><span style=" font-family:'Ubuntu';">братите внимание на пару моментов:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="5620"></a><span style=" font-family:'Ubuntu';">1</span><span style=" font-family:'Ubuntu';">. Имя директории на локальной машине, где хранится репозиторий, и имя репозитория в URL должны совпадать (особенно актуально, если клонирование выполнялось через однострочник выше).</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="e53f"></a><span style=" font-family:'Ubuntu';">2</span><span style=" font-family:'Ubuntu';">. Каждый репозиторий извлекается в ветку для отправки (например, </span><span style=" font-family:'Courier New,courier';">master</span><span style=" font-family:'Ubuntu';">).</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="5762"></a><span style=" font-family:'Ubuntu';">Н</span><span style=" font-family:'Ubuntu';">аш однострочник можно дополнить с учетом вышеперечисленных нюансов. Однако по скромному мнению автора лучше делать это через Bash-скрипты.</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="18c1"></a><span style=" font-family:'Ubuntu'; font-size:x-large; font-weight:600;">К</span><span style=" font-family:'Ubuntu'; font-size:x-large; font-weight:600;">ак это работает?</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="804b"></a><span style=" font-family:'Ubuntu';">B</span><span style=" font-family:'Ubuntu';">ash-однострочник берет каждую строку (или URL) из файла </span><span style=" font-family:'Courier New,courier';">gl-repos.txt</span><span style=" font-family:'Ubuntu';"> в качестве входного значения. С помощью </span><span style=" font-family:'Courier New,courier';">awk </span><span style=" font-family:'Ubuntu';">он отсекает имя директории, в которой репозиторий хранится на локальном компьютере, и использует эти фрагменты информации для создания более длинной команды. Если мы захотим вывести результат </span><span style=" font-family:'Courier New,courier';">awk</span><span style=" font-family:'Ubuntu';"> через </span><span style=" font-family:'Courier New,courier';">print</span><span style=" font-family:'Ubuntu';">, то увидим:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="b4e1"></a><span style=" font-family:'Courier New,courier'; font-weight:600;">c</span><span style=" font-family:'Courier New,courier'; font-weight:600;">d </span><span style=" font-family:'Courier New,courier';">~/FULL/PATH/first-repository &amp;&amp; </span><span style=" font-family:'Courier New,courier'; font-weight:600;">git </span><span style=" font-family:'Courier New,courier';">remote set-url origin — add git@gitlab.com:username/first-repository.git &amp;&amp; </span><span style=" font-family:'Courier New,courier'; font-weight:600;">git</span><span style=" font-family:'Courier New,courier';"> push<br /></span><span style=" font-family:'Courier New,courier'; font-weight:600;">cd</span><span style=" font-family:'Courier New,courier';"> ~/FULL/PATH/second-repository &amp;&amp; </span><span style=" font-family:'Courier New,courier'; font-weight:600;">git </span><span style=" font-family:'Courier New,courier';">remote set-url origin — add git@gitlab.com:username/second-repository.git &amp;&amp; </span><span style=" font-family:'Courier New,courier'; font-weight:600;">git </span><span style=" font-family:'Courier New,courier';">push<br /></span><span style=" font-family:'Courier New,courier'; font-weight:600;">cd </span><span style=" font-family:'Courier New,courier';">~/FULL/PATH/third-repository &amp;&amp; </span><span style=" font-family:'Courier New,courier'; font-weight:600;">git </span><span style=" font-family:'Courier New,courier';">remote set-url origin — add git@gitlab.com:username/third-repository.git &amp;&amp; </span><span style=" font-family:'Courier New,courier'; font-weight:600;">git </span><span style=" font-family:'Courier New,courier';">push</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="2921"></a><span style=" font-family:'Ubuntu';">Д</span><span style=" font-family:'Ubuntu';">авайте рассмотрим, из чего складывается эта команда.</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="30aa"></a><span style=" font-family:'Ubuntu'; font-size:x-large; font-weight:600;">Р</span><span style=" font-family:'Ubuntu'; font-size:x-large; font-weight:600;">азделение строк через awk</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="c03d"></a><span style=" font-family:'Ubuntu';">И</span><span style=" font-family:'Ubuntu';">нструмент </span><span style=" font-family:'Courier New,courier';">awk</span><span style=" font-family:'Ubuntu';"> разделяет входные значения с помощью разделителей полей. Стандартный разделитель — это символ пробела. Однако это значение можно изменить через передачу флажка </span><span style=" font-family:'Courier New,courier';">-F</span><span style=" font-family:'Ubuntu';">. Также вы можете разделять поля с помощью регулярных выражений. А поскольку URL репозиториев заданы в определенном формате, то можно получить их имена по запросу подстроки между символом косой черты </span><span style=" font-family:'Courier New,courier';">/</span><span style=" font-family:'Ubuntu';"> и концом URL —</span><span style=" font-family:'Courier New,courier';"> .git</span><span style=" font-family:'Ubuntu';">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="7872"></a><span style=" font-family:'Ubuntu';">З</span><span style=" font-family:'Ubuntu';">десь нам поможет регулярное выражение </span><span style=" font-family:'Courier New,courier';">\/|(\.git)</span><span style=" font-family:'Ubuntu';">:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Ubuntu';" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="5490"></a><span style=" font-family:'Courier New,courier';">\</span><span style=" font-family:'Courier New,courier';">/</span> — это экранированный символ<span style=" font-family:'Courier New,courier';"> /</span>;</li>
<li style=" font-family:'Ubuntu';" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="e3e2"></a><span style=" font-family:'Courier New,courier';">|</span> означает «или». Он предписывает <span style=" font-family:'Courier New,courier';">awk</span> искать соответствия какому-либо выражению;</li>
<li style=" font-family:'Ubuntu';" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="8b5c"></a><span style=" font-family:'Courier New,courier';">(</span><span style=" font-family:'Courier New,courier';">\.git)</span> — это группа записи в конце нашего URL-адреса, которая сопоставляет <span style=" font-family:'Courier New,courier';">.git</span> с экранированным символом. Не обошлось здесь и без, своего рода, обмана: сам <span style=" font-family:'Courier New,courier';">.git</span> ничего нигде не отделяет (поскольку там ничего нет), но так нам проще всего заполучить нужный фрагмент.</li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="d325"></a><span style=" font-family:'Ubuntu';">С</span><span style=" font-family:'Ubuntu';">начала мы указываем </span><span style=" font-family:'Courier New,courier';">awk</span><span style=" font-family:'Ubuntu';"> на место разделения, а затем через оператора поля получаем нужную подстроку. Для обращения к полю воспользуемся символом </span><span style=" font-family:'Courier New,courier';">$</span><span style=" font-family:'Ubuntu';"> и укажем номер столбца этого поля. В нашем примере нам нужно второе поле — </span><span style=" font-family:'Courier New,courier';">$2</span><span style=" font-family:'Ubuntu';">. Вот так выглядят все подстроки:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="395e"></a><span style=" font-family:'Courier New,courier';">1</span><span style=" font-family:'Courier New,courier';">: git@gitlab.com:username<br />2: first-repository</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="26df"></a><span style=" font-family:'Ubuntu';">Д</span><span style=" font-family:'Ubuntu';">ля использования всей строки (или же, как в нашем случае, — всего URL-адреса) можно прибегнуть к оператору поля </span><span style=" font-family:'Courier New,courier';">$0</span><span style=" font-family:'Ubuntu';">. В этом случае мы просто подставляем операторы поля для имени и URL репозитория. Чтобы проверить правильность расстановки пробелов, достаточно выполнить данную команду с </span><span style=" font-family:'Courier New,courier';">print</span><span style=" font-family:'Ubuntu';">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="9190"></a><span style=" font-family:'Courier New,courier';">a</span><span style=" font-family:'Courier New,courier';">wk -F’\/|(\.git)’ ‘{print “cd ~/FULL/PATH/” $2 “ &amp;&amp; git remote set-url origin — add “ $0 “ &amp;&amp; git push”}’ gl-repos.txt</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="cae1"></a><span style=" font-family:'Ubuntu'; font-size:x-large; font-weight:600;">В</span><span style=" font-family:'Ubuntu'; font-size:x-large; font-weight:600;">ыполнение команды</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="ddaa"></a><span style=" font-family:'Ubuntu';">Н</span><span style=" font-family:'Ubuntu';">аша команда создается внутри круглых скобок </span><span style=" font-family:'Courier New,courier';">system()</span><span style=" font-family:'Ubuntu';">. Если задать значение в скобках в качестве вывода </span><span style=" font-family:'Courier New,courier';">awk</span><span style=" font-family:'Ubuntu';">, то можно будет выполнять каждую команду сразу после ее создания и вывода. Функция </span><span style=" font-family:'Courier New,courier';">system() </span><span style=" font-family:'Ubuntu';">создает дочерний процесс, который выполняет нашу команду, а затем возвращается после завершения команды. Другими словами, так мы можем выполнять Git-команды в каждом репозитории последовательно и без отрыва от основного процесса, в котором </span><span style=" font-family:'Courier New,courier';">awk </span><span style=" font-family:'Ubuntu';">работает с файлом вывода. Вот как выглядит итоговая сборка команды:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="05d4"></a><span style=" font-family:'Courier New,courier'; font-weight:600;">a</span><span style=" font-family:'Courier New,courier'; font-weight:600;">wk</span><span style=" font-family:'Courier New,courier';"> -F’\/|(\.git)’ ‘{system(“cd ~/FULL/PATH/” </span><span style=" font-family:'Courier New,courier'; font-weight:600;">$2</span><span style=" font-family:'Courier New,courier';"> “ &amp;&amp; git remote set-url origin — add “ </span><span style=" font-family:'Courier New,courier'; font-weight:600;">$0</span><span style=" font-family:'Courier New,courier';"> “ &amp;&amp; git push”)}’ gl-repos.txt</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="7f0f"></a><span style=" font-family:'Ubuntu'; font-size:x-large; font-weight:600;">И</span><span style=" font-family:'Ubuntu'; font-size:x-large; font-weight:600;">спользование резервных копий</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="b22e"></a><span style=" font-family:'Ubuntu';">Д</span><span style=" font-family:'Ubuntu';">обавляя URL-адреса GitLab в качестве удаленных репозиториев, мы упрощаем процесс отправки изменений на внешние репозитории. Если в одной из своих директорий репозитория мы выполним </span><span style=" font-family:'Courier New,courier';">git remote -v</span><span style=" font-family:'Ubuntu';">, то увидим:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="c6fe"></a><span style=" font-family:'Courier New,courier';">o</span><span style=" font-family:'Courier New,courier';">rigin git@github.com:username/first-repository.git (fetch)<br />origin git@github.com:username/first-repository.git (push)<br />origin git@gitlab.com:username/first-repository.git (push)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="dc9d"></a><span style=" font-family:'Ubuntu';">Т</span><span style=" font-family:'Ubuntu';">еперь простое выполнение </span><span style=" font-family:'Courier New,courier';">git push</span><span style=" font-family:'Ubuntu';"> без аргументов отправит текущую ветвь на оба удаленных репозитория.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="e3c4"></a><span style=" font-family:'Ubuntu';">З</span><span style=" font-family:'Ubuntu';">десь стоит отметить тот факт, что </span><span style=" font-family:'Courier New,courier';">git pull</span><span style=" font-family:'Ubuntu';"> попытается загрузить изменения только из того удаленного репозитория, с которого изначально осуществлялось клонирование (это URL с меткой </span><span style=" font-family:'Courier New,courier';">(fetch)</span><span style=" font-family:'Ubuntu';"> из примера выше). Одновременная загрузка сразу из нескольких Git-репозиториев также возможна, однако реализовать ее довольно сложно.</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="555a"></a><span style=" font-family:'Ubuntu'; font-size:x-large; font-weight:600;">П</span><span style=" font-family:'Ubuntu'; font-size:x-large; font-weight:600;">ара слов о краткости Bash-однострочников</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="888a"></a><span style=" font-family:'Ubuntu';">П</span><span style=" font-family:'Ubuntu';">ри должном понимании Bash-однострочники превращаются в удобный и интересный инструмент для работы. Как минимум, такие инструменты, как </span><span style=" font-family:'Courier New,courier';">xargs</span><span style=" font-family:'Ubuntu';"> и </span><span style=" font-family:'Courier New,courier';">awk</span><span style=" font-family:'Ubuntu';">, позволят вам автоматизировать и облегчить рутинную работу. Но есть здесь и существенные недостатки.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="fadd"></a><span style=" font-family:'Ubuntu';">B</span><span style=" font-family:'Ubuntu';">ash-однострочники — не самый удачный выбор, если вы ищите простые для понимания, поддержки и реализации инструменты. Написание однострочников куда сложнее, чем создание Bash-скриптов с циклами </span><span style=" font-family:'Courier New,courier';">if</span><span style=" font-family:'Ubuntu';"> или </span><span style=" font-family:'Courier New,courier';">while</span><span style=" font-family:'Ubuntu';">, а их читабельность еще хуже. Скорее всего, при написании однострочника где-то потеряется кавычка или закрывающая скобка, и найти это будет весьма непросто. Так зачем же нужны Bash-однострочники?</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="2908"></a><span style=" font-family:'Ubuntu';">П</span><span style=" font-family:'Ubuntu';">редставьте себе, что вы читаете пошаговый рецепт приготовления пирога. Вы разобрались в способе приготовления и ингредиентах, а также заготовили все необходимое. Затем вы перечитываете рецепт и понимаете, что пирог приготовится «на ура», если просто закинуть все эти ингредиенты в духовку в правильном порядке. Вы пробуете приготовить по рецепту, и все получается! Приятно, да?</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="3090"></a><span style=" font-family:'Ubuntu';">Ч</span><span style=" font-family:'Ubuntu';">итайте также:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Ubuntu';" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="fe47"></a><a href="https://nuancesprog.ru/p/4098/"><span style=" text-decoration: underline; color:#0000ff;">T</span></a><span style=" text-decoration: underline; color:#0000ff;">op 100 наиболее популярных репозиториев на GitHub</span></li>
<li style=" font-family:'Ubuntu';" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="849a"></a><a href="https://nuancesprog.ru/p/3111/"><span style=" text-decoration: underline; color:#0000ff;">К</span></a><span style=" text-decoration: underline; color:#0000ff;">ак стать продуктивнее на GitHub</span></li>
<li style=" font-family:'Ubuntu';" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="d346"></a><a href="https://nuancesprog.ru/p/3598/"><span style=" text-decoration: underline; color:#0000ff;">О</span></a><span style=" text-decoration: underline; color:#0000ff;">сновы Git за 5 минут</span></li></ul>
<hr />
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="7006"></a><span style=" font-family:'Ubuntu'; font-style:italic;">П</span><span style=" font-family:'Ubuntu'; font-style:italic;">еревод статьи </span><a href="https://www.freecodecamp.org/news/author/victoria/"><span style=" font-family:'Ubuntu'; font-style:italic; text-decoration: underline; color:#0000ff;">Victoria Drake</span></a><span style=" font-family:'Ubuntu'; font-style:italic;">: </span><a href="https://www.freecodecamp.org/news/bash-one-liners-for-github-and-gitlab/"><span style=" font-family:'Ubuntu'; font-style:italic; text-decoration: underline; color:#0000ff;">How to write Bash one-liners for cloning and managing GitHub and GitLab repositories</span></a></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://medium.com/nuances-of-programming?source=post_sidebar--------------------------post_sidebar-"><span style=" font-family:'Ubuntu'; font-size:x-large; font-weight:600; text-decoration: underline; color:#0000ff;">NOP::Nuances of programming</span></a></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-size:medium; font-weight:600;">Перевод и адаптация статей в сфере IT</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Ubuntu'; font-size:medium; font-weight:600;"><br /></p></body></html>