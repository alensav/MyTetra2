<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%; background-color:#ffffff;"><a name="_dd-2"></a><span style=" font-family:'Source Sans Pro'; font-size:10pt; color:#444444; text-transform:uppercase;">К</span><span style=" font-family:'Source Sans Pro'; font-size:10pt; color:#444444; text-transform:uppercase;">ОМАНДА DD</span></p>
<p style=" margin-top:0px; margin-bottom:25px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Open Sans'; font-size:10pt; color:#444444; background-color:#ffffff;">Синтаксис утилиты достаточно необычен, но в то же время очень прост, после того как вы его запомните и привыкнете:</span></p>
<p style=" margin-top:0px; margin-bottom:25px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'inherit'; font-size:10pt; color:#99cc00;">$ dd</span><span style=" font-family:'inherit'; font-size:10pt; font-weight:600; color:#444444;"> </span><span style=" font-family:'inherit'; font-size:10pt; color:#3366ff;">if=</span><span style=" font-family:'inherit'; font-size:10pt; color:#993366;">источник_копирования</span><span style=" font-family:'inherit'; font-size:10pt; color:#3366ff;"> of=</span><span style=" font-family:'inherit'; font-size:10pt; color:#993366;">место_назначения</span><span style=" font-family:'inherit'; font-size:10pt; font-weight:600; color:#444444;"> </span><span style=" font-family:'inherit'; font-size:10pt; color:#339966;">параметры</span></p>
<p style=" margin-top:0px; margin-bottom:25px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Open Sans'; font-size:10pt; color:#444444; background-color:#ffffff;">С помощью параметра if вам нужно указать источник, откуда будут копироваться блоки, это может быть устройство, например, /dev/sda или файл - disk.img. Дальше, с помощью параметра of необходимо задать устройство или файл назначения. Другие параметры имеют такой же синтаксис, как if и of.</span></p>
<p style=" margin-top:0px; margin-bottom:25px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Open Sans'; font-size:10pt; color:#444444; background-color:#ffffff;">Теперь давайте рассмотрим дополнительные параметры:</span></p>
<ul type="square" style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Open Sans'; font-size:10pt; color:#444444;" style=" margin-top:29px; margin-bottom:0px; margin-left:36px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; font-weight:600;">bs</span><span style=" font-size:16px;"> - указывает сколько байт читать и записывать за один раз;</span></li>
<li style=" font-family:'Open Sans'; font-size:10pt; color:#444444;" style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; font-weight:600;">cbs</span><span style=" font-size:16px;"> - сколько байт нужно записывать за один раз;</span></li>
<li style=" font-family:'Open Sans'; font-size:10pt; color:#444444;" style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; font-weight:600;">count</span><span style=" font-size:16px;"> - скопировать указанное количество блоков, размер одного блока указывается в параметре bs;</span></li>
<li style=" font-family:'Open Sans'; font-size:10pt; color:#444444;" style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; font-weight:600;">conv</span><span style=" font-size:16px;"> - применить фильтры к потоку данных;</span></li>
<li style=" font-family:'Open Sans'; font-size:10pt; color:#444444;" style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; font-weight:600;">ibs</span><span style=" font-size:16px;"> - читать указанное количество байт за раз;</span></li>
<li style=" font-family:'Open Sans'; font-size:10pt; color:#444444;" style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; font-weight:600;">obs</span><span style=" font-size:16px;"> - записывать указанное количество байт за раз;</span></li>
<li style=" font-family:'Open Sans'; font-size:10pt; color:#444444;" style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; font-weight:600;">seek</span><span style=" font-size:16px;"> - пропустить указанное количество байт в начале устройства для чтения;</span></li>
<li style=" font-family:'Open Sans'; font-size:10pt; color:#444444;" style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; font-weight:600;">skip</span><span style=" font-size:16px;"> - пропустить указанное количество байт в начале устройства вывода;</span></li>
<li style=" font-family:'Open Sans'; font-size:10pt; color:#444444;" style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; font-weight:600;">status</span><span style=" font-size:16px;"> - указывает насколько подробным нужно сделать вывод;</span></li>
<li style=" font-family:'Open Sans'; font-size:10pt; color:#444444;" style=" margin-top:0px; margin-bottom:30px; margin-left:36px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; font-weight:600;">iflag, oflag</span><span style=" font-size:16px;"> - позволяет задать дополнительные флаги работы для устройства ввода и вывода, основные из них: nocache, nofollow.</span></li></ul>
<p style=" margin-top:0px; margin-bottom:25px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Open Sans'; font-size:10pt; color:#444444; background-color:#ffffff;">Это были все основные опции, которые вам могут понадобиться. Теперь перейдем ближе к практике и рассмотрим несколько примеров как пользоваться утилитой dd linux.</span></p>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%; background-color:#ffffff;"><a name="_dd-3"></a><span style=" font-family:'Source Sans Pro'; font-size:10pt; color:#444444; text-transform:uppercase;">К</span><span style=" font-family:'Source Sans Pro'; font-size:10pt; color:#444444; text-transform:uppercase;">АК ПОЛЬЗОВАТЬСЯ DD?</span></p>
<p style=" margin-top:0px; margin-bottom:25px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Open Sans'; font-size:10pt; color:#444444; background-color:#ffffff;">Обычные пользователи используют команду dd чаще всего для создания образов дисков DVD или CD. Например, чтобы сохранить образ диска в файл можно использовать такую команду:</span></p>
<p style=" margin-top:0px; margin-bottom:25px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'inherit'; font-size:10pt; color:#444444; background-color:rgba(0,0,0,0.047059);"> sudo dd if=/dev/sr0 of=~/CD.iso bs=2048 conv=noerror</span></p>
<p style=" margin-top:0px; margin-bottom:25px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Open Sans'; font-size:10pt; color:#444444; background-color:#ffffff;"> </span></p>
<p style=" margin-top:0px; margin-bottom:25px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Open Sans'; font-size:10pt; color:#444444; background-color:#ffffff;">Фильтр noerror позволяет отключить реагирование на ошибки. Дальше, вы можете создать образ жесткого диска или раздела на нем и сохранить этот образ на диск. Только смотрите не сохраните на тот же жесткий диск или раздел, чтобы не вызвать рекурсию:</span></p>
<p style=" margin-top:0px; margin-bottom:25px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'inherit'; font-size:10pt; color:#444444; background-color:rgba(0,0,0,0.047059);"> dd if=/dev/sda of=~/disk.img</span></p>
<p style=" margin-top:0px; margin-bottom:25px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="aswift_1_expand"></a><span style=" font-family:'Open Sans'; font-size:10pt; color:#444444; background-color:#ffffff;"> </span></p>
<p style=" margin-top:0px; margin-bottom:25px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Open Sans'; font-size:10pt; color:#444444; background-color:#ffffff;">В вашей домашней папке будет создан файл с именем disk1.img, который в будущем можно будет развернуть и восстановить испорченную систему. Чтобы записать образ на жесткий диск или раздел достаточно поменять местами адреса устройств:</span></p>
<p style=" margin-top:0px; margin-bottom:25px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'inherit'; font-size:10pt; color:#444444; background-color:rgba(0,0,0,0.047059);"> dd of=~/disk.img if=/dev/sda</span></p>
<p style=" margin-top:0px; margin-bottom:25px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Open Sans'; font-size:10pt; color:#444444; background-color:#ffffff;">Очень важная и полезная опция - это bs. Она позволяет очень сильно влиять на скорость работы утилиты. Этот параметр позволяет установить размер одного блока при передаче данных. Здесь нужно задать цифровое значение с одним из таких модификаторов формата:</span></p>
<ul type="square" style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Open Sans'; font-size:10pt; color:#444444;" style=" margin-top:29px; margin-bottom:0px; margin-left:36px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; font-weight:600;">с</span><span style=" font-size:16px;"> - один символ;</span></li>
<li style=" font-family:'Open Sans'; font-size:10pt; color:#444444;" style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; font-weight:600;">b</span><span style=" font-size:16px;"> - 512 байт;</span></li>
<li style=" font-family:'Open Sans'; font-size:10pt; color:#444444;" style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; font-weight:600;">kB</span><span style=" font-size:16px;"> - 1000 байт;</span></li>
<li style=" font-family:'Open Sans'; font-size:10pt; color:#444444;" style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; font-weight:600;">K</span><span style=" font-size:16px;"> - 1024 байт;</span></li>
<li style=" font-family:'Open Sans'; font-size:10pt; color:#444444;" style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; font-weight:600;">MB</span><span style=" font-size:16px;"> - 1000 килобайт;</span></li>
<li style=" font-family:'Open Sans'; font-size:10pt; color:#444444;" style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; font-weight:600;">M</span><span style=" font-size:16px;"> - 1024 килобайт;</span></li>
<li style=" font-family:'Open Sans'; font-size:10pt; color:#444444;" style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; font-weight:600;">GB</span><span style=" font-size:16px;"> - 1000 мегабайт;</span></li>
<li style=" font-family:'Open Sans'; font-size:10pt; color:#444444;" style=" margin-top:0px; margin-bottom:30px; margin-left:36px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; font-weight:600;">G</span><span style=" font-size:16px;"> - 1024 мегабайт.</span></li></ul>
<p style=" margin-top:0px; margin-bottom:25px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Open Sans'; font-size:10pt; color:#444444; background-color:#ffffff;">Команда dd linux использует именно такую систему, она сложная, но от этого никуда не деться. Ее придется понять и запомнить. Например, 2b - это 1 килобайт, и 1k, это тоже 1 килобайт, 1М - 1 мегабайт. По умолчанию утилита использует размер блока - 512 байт. Например, чтобы ускорить копирование диска можно брать блоки размером по 5 мегабайт. Для этого применяется такая команда:</span></p>
<p style=" margin-top:0px; margin-bottom:25px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'inherit'; font-size:10pt; color:#444444; background-color:rgba(0,0,0,0.047059);"> dd if=/dev/sda of=~/disk.img bs=5M</span></p>
<p style=" margin-top:0px; margin-bottom:25px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><img src="image1253511361.png" /></p>
<p style=" margin-top:0px; margin-bottom:25px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Open Sans'; font-size:10pt; color:#444444; background-color:#ffffff;">Следующий параметр - это count. С помощью него можно указать сколько блоков необходимо скопировать. Например, мы можем создать файл размером 512 мегабайт, заполнив его нулями из /dev/zero или случайными цифрами из /dev/random:</span></p>
<p style=" margin-top:0px; margin-bottom:25px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'inherit'; font-size:10pt; color:#444444; background-color:rgba(0,0,0,0.047059);"> sudo dd if=/dev/zero of=file.img bs=1M count=512</span></p>
<p style=" margin-top:0px; margin-bottom:25px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><img src="image1825525953.png" /></p>
<p style=" margin-top:0px; margin-bottom:25px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Open Sans'; font-size:10pt; color:#444444; background-color:#ffffff;">Обратите внимание, что этот параметр указывает не размер в мегабайтах, а всего лишь количество блоков. Поэтому, если вы укажите размер блока 1b, то для создания файла размером 1Кб нужно взять только два блока. С помощью этого параметра также можно сделать резервную копию таблицы разделов MBR. Для этого скопируем в файл первые 512 байт жесткого диска:</span></p>
<p style=" margin-top:0px; margin-bottom:25px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'inherit'; font-size:10pt; color:#444444; background-color:rgba(0,0,0,0.047059);"> sudo dd if=/dev/sda of=mbr.img bs=1b count=1</span></p>
<p style=" margin-top:0px; margin-bottom:25px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><img src="image1978728771.png" /></p>
<p style=" margin-top:0px; margin-bottom:25px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Open Sans'; font-size:10pt; color:#444444; background-color:#ffffff;">Для восстановления используйте обычную команду развертывания образа на диск.</span></p>
<p style=" margin-top:0px; margin-bottom:25px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Open Sans'; font-size:10pt; color:#444444; background-color:#ffffff;">Если образ диска слишком большой, можно перенаправить весь вывод нестандартный поток вывода утилиты gzip:</span></p>
<p style=" margin-top:0px; margin-bottom:25px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'inherit'; font-size:10pt; color:#444444; background-color:rgba(0,0,0,0.047059);"> dd if =/dev/sda2 | bzip2 disk.img.bz2</span></p>
<p style=" margin-top:0px; margin-bottom:25px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Open Sans'; font-size:10pt; color:#444444; background-color:#ffffff;">Также можно использовать утилиту dd linux для копирования файлов, хотя это и не является ее прямым предназначением:</span></p>
<p style=" margin-top:0px; margin-bottom:25px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'inherit'; font-size:10pt; color:#444444; background-color:rgba(0,0,0,0.047059);"> dd if=/home/sergiy/test.txt of=/home/sergiy/test1.txt</span></p>
<p style=" margin-top:0px; margin-bottom:25px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Open Sans'; font-size:10pt; color:#444444; background-color:#ffffff;">Как вы знаете, команда dd linux пишет данные на диск непосредственно в двоичном виде, это значит, что записываются нули и единицы. Они переопределяют то, что было раньше размещено на устройстве для записи. Поэтому чтобы стереть диск вы можете просто забить его нулями из /dev/zero.</span></p>
<p style=" margin-top:0px; margin-bottom:25px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'inherit'; font-size:10pt; color:#444444; background-color:rgba(0,0,0,0.047059);"> sudo dd if=/dev/zero of=/dev/sdb</span></p>
<p style=" margin-top:0px; margin-bottom:25px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Open Sans'; font-size:10pt; color:#444444; background-color:#ffffff;">Такое использование dd приводит к тому что весь диск будет полностью стерт.</span></p>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.4%; background-color:#ffffff;"><a name="i"></a><span style=" font-family:'Source Sans Pro'; font-size:10pt; color:#444444; text-transform:uppercase;">В</span><span style=" font-family:'Source Sans Pro'; font-size:10pt; color:#444444; text-transform:uppercase;">ЫВОДЫ</span></p>
<p style=" margin-top:0px; margin-bottom:25px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Open Sans'; font-size:10pt; color:#444444; background-color:#ffffff;">В этой статье мы рассмотрели как пользоваться dd linux, для чего можно применять эту утилиту и насколько она может быть полезной. Это почти незаменимый инструмент системного администратора, поскольку с помощью нее можно делать резервные копии целой системы. И теперь вы знаете как. Если у вас остались вопросы, спрашивайте в комментариях!</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-size:10pt;"> </span></p></body></html>