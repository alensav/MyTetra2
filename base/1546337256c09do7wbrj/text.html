<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">#!/bin/bash<br /><br />#Чтобы поставить будильник, вводим в терминале команду &quot;crontab -e&quot;<br />#И прописываем нужные параметры:<br />## m h  dom mon dow   command<br />#0 7 * * 1-5 ./alarm.sh<br />#0 10 * * 6-7 ./alarm.sh<br /><br /><br />export DISPLAY=:0<br />export LANG=ru_RU.UTF-8<br /><br /><br /># Выбираем нужный синтезатор речи, раскомментировав одну из строк:<br />#sayit () { espeak -vru -s130; }<br />#sayit () { festival --tts --language russian; }<br />#sayit () { festival_client --ttw | aplay -q; }<br />sayit () { RHVoice | aplay -q; }<br /><br /><br /># Склоняем в соответствующем падеже слова &quot;час&quot; и &quot;минута&quot;<br /><br />check_date ()<br /><br />{<br /><br />HOUR=`date +%H`<br />MIN=`date +%M`<br /><br />if [[ &quot;$HOUR&quot; = 1[1234] || &quot;$HOUR&quot; = ?[056789] ]]; then LC_HOUR=&quot;часов&quot;<br />elif [[ &quot;$HOUR&quot; = ?[234] ]]; then LC_HOUR=&quot;час+а&quot;<br />elif [[ &quot;$HOUR&quot; = ?1 ]]; then LC_HOUR=&quot;час&quot;<br />else LC_HOUR=&quot;значение не определено&quot;<br />fi<br /><br />if [[ &quot;$MIN&quot; = 1[1234] || &quot;$MIN&quot; = ?[056789] ]]; then LC_MINUTE=&quot;минут&quot;<br />elif [[ &quot;$MIN&quot; = ?[34] ]]; then LC_MINUTE=&quot;минуты&quot;<br />else LC_MINUTE=&quot;значение не определено&quot;<br />fi<br /><br />if [[ &quot;$MIN&quot; = 01 ]]; then TIME=&quot;$HOUR $LC_HOUR однa минута&quot;<br />elif [[ &quot;$MIN&quot; = 11 ]]; then TIME=&quot;$HOUR $LC_HOUR $MIN $LC_MINUTE&quot;<br />elif [[ &quot;$MIN&quot; = ?1 ]]; then TIME=&quot;$HOUR $LC_HOUR $(($MIN-1)) одна минута&quot;<br />elif [[ &quot;$MIN&quot; = 02 ]]; then TIME=&quot;$HOUR $LC_HOUR две минуты&quot;<br />elif [[ &quot;$MIN&quot; = 12 ]]; then TIME=&quot;$HOUR $LC_HOUR $MIN $LC_MINUTE&quot;<br />elif [[ &quot;$MIN&quot; = ?2 ]]; then TIME=&quot;$HOUR $LC_HOUR $(($MIN-2)) две минуты&quot;<br />elif [[ &quot;$MIN&quot; = 00 ]]; then TIME=&quot;$HOUR $LC_HOUR ровно&quot;<br />else TIME=&quot;$HOUR $LC_HOUR $MIN $LC_MINUTE&quot;<br />fi<br /><br />if [[ &quot;$HOUR&quot; = 08 ]] || [[ &quot;$HOUR&quot; -ge 06 &amp;&amp; &quot;$HOUR&quot; -le 11 ]]; then<br />HELLO=&quot;Доброе утро&quot;<br />elif [[ &quot;$HOUR&quot; -ge 12 &amp;&amp; &quot;$HOUR&quot; -le 17 ]]; then<br />HELLO=&quot;Добрый день&quot;<br />elif [[ &quot;$HOUR&quot; -ge 18 &amp;&amp; &quot;$HOUR&quot; -le 23 ]]; then<br />HELLO=&quot;Добрый вечер&quot;<br />elif [[ &quot;$HOUR&quot; -ge 00 &amp;&amp; &quot;$HOUR&quot; -le 05 ]]; then<br />HELLO=&quot;Доброй ночи&quot;<br />else HELLO=&quot;Привет&quot;<br />fi<br /><br />}<br /><br /><br /># Выясняем, в каком городе мы находимся<br /><br />CITY=`wget -q -O - 2ip.ru | grep -P geoip | sed 's/&lt;[^&gt;]*&gt;//g' | awk '{print $3}'`<br /><br />CITY_ID=`wget -q -O - http://bar.gismeteo.ru/gmbartlist.xml | iconv -f cp1251 -t utf8 | grep $CITY | awk '{print $3}' | sed 's/[i=&quot;]//g'`<br /><br />TMP_FILE=&quot;/tmp/gismeteo_$CITY_ID&quot;<br /><br />URL=&quot;http://www.gismeteo.ru/ztowns/$CITY_ID.htm&quot; #CITY_ID - не тот, к которому привыкли, но перенаправляет, куда надо. Информер: http://informer.gismeteo.ru/xml/$CITY_ID_1.xml<br /><br /><br /># Получаем температуру в своем городе<br /><br />wget -q -O - $URL &gt; $TMP_FILE<br /><br />TEMP=&quot;`grep -m 1 'value m_temp c' $TMP_FILE | sed 's/&lt;[^&gt;]*&gt;/ /g' | awk '{print $1}'`&quot;<br /><br />if [[ `echo $TEMP | grep minus` ]]; then TEMP_SIGN=&quot;минус&quot;<br />else TEMP_SIGN=&quot;&quot;<br />fi<br /><br />DEGREE=&quot;`echo $TEMP | grep -Po '[0-9]{1,2}'`&quot;<br /><br /><br /># Проверяем погодные условия<br /><br />WEATH=&quot;`grep -m 1 '&lt;dd&gt;' $TMP_FILE | sed 's/[ \t]*//;s/&lt;[^&gt;]*&gt;//g'`&quot;<br /><br /><br /># Склоняем в соответствующем падеже слово &quot;градус&quot;<br /><br />if [[ &quot;$DEGREE&quot; = 1[1234] || &quot;$DEGREE&quot; = *[056789] ]]; then LC_DEGREE=&quot;градусов&quot;<br />elif [[ &quot;$DEGREE&quot; = *[234] ]]; then LC_DEGREE=&quot;градуса&quot;<br />elif [[ &quot;$DEGREE&quot; = *1 ]]; then LC_DEGREE=&quot;градус&quot;<br />else LC_DEGREE=&quot;значение не определено&quot;<br />fi<br /><br /><br /># начальная громкость, в процентах<br />VOLUME=25<br /># конечная (максимальная) громкость, в процентах<br />MAXVOLUME=65<br /><br /><br /># А теперь сам будильник<br /><br />amixer -q sset Master $VOLUME% unmute<br />if [[ `ps h -C rhythmbox` ]]<br />then sleep 10<br />else rhythmbox &amp;&gt; /dev/null &amp; sleep 10<br />fi<br />rhythmbox-client --set-volume 1.0<br /><br />playlist=&quot;`qdbus --literal org.mpris.MediaPlayer2.rhythmbox /org/mpris/MediaPlayer2 org.mpris.MediaPlayer2.Playlists.GetPlaylists 1 1 0 0 | sed -e :a -e 's/\][^&gt;]*\]//g;s/\[[^&gt;]*\[ObjectPath: //g'`&quot; #Ищем динамический плейлист &quot;Любимые композиции&quot;<br />qdbus org.mpris.MediaPlayer2.rhythmbox /org/mpris/MediaPlayer2 org.mpris.MediaPlayer2.Playlists.ActivatePlaylist $playlist #Запускаем найденный плейлист<br />rhythmbox-client --next<br /><br />#rhythmbox-client --play-uri=&quot;http://online.radiorecord.ru:8102/tm_128&quot; #Можно и радио послушать<br /><br />while [[ &quot;$VOLUME&quot; -le &quot;$MAXVOLUME&quot; ]]<br />do<br />VOLUME=$(($VOLUME+1))<br />sleep 1<br />amixer -q sset Master $VOLUME% unmute<br />done<br /><br />sleep 230<br /><br />rhythmbox-client --set-volume 0.9<br />sleep 1<br />rhythmbox-client --set-volume 0.8<br />sleep 1<br />rhythmbox-client --set-volume 0.7<br />sleep 1<br />rhythmbox-client --set-volume 0.6<br />sleep 1<br />rhythmbox-client --set-volume 0.5<br />sleep 1<br />rhythmbox-client --set-volume 0.4<br /><br />check_date<br />echo &quot;$HELLO, Хозяин&quot; | sayit<br />echo &quot;Я надеюсь, что вы хорошо спали?&quot; | sayit<br />echo &quot;Сегодня `date +%A`&quot; | sayit<br />echo &quot;Время $TIME&quot; | sayit<br />echo &quot;Температура за окном $TEMP_SIGN $DEGREE $LC_DEGREE, $WEATH&quot; | sayit<br />echo &quot;Желаю вам удач+нава дня&quot; | sayit<br /><br />rhythmbox-client --set-volume 0.5<br />sleep 1<br />rhythmbox-client --set-volume 0.6<br />sleep 1<br />rhythmbox-client --set-volume 0.7<br />sleep 1<br />rhythmbox-client --set-volume 0.8<br />sleep 1<br />rhythmbox-client --set-volume 0.9<br />sleep 1<br />rhythmbox-client --set-volume 1.0<br /><br />exit 0</span></pre></body></html>