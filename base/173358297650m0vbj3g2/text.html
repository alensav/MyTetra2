<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">1.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">SETTING_MOSQUITTO</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">https://www.8host.com/blog/ustanovka-brokera-soobshhenij-mosquitto-v-ubuntu-18-04/</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">2.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">https://www.ekzorchik.ru/2019/05/how-to-enable-mqtt-server-on-ubuntu-18-04/<br />3.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">https://hostadvice.com/how-to/web-hosting/ubuntu/how-to-install-and-configure-mosquitto-mqtt-on-your-ubuntu-18-04-server/#</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">4.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">https://www.digitalocean.com/community/tutorials/how-to-install-and-secure-the-mosquitto-mqtt-messaging-broker-on-ubuntu-18-04-quickstart?_x_tr_sl=en&amp;_x_tr_tl=ru&amp;_x_tr_hl=ru&amp;_x_tr_pto=sc</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">==================</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; font-weight:496; color:#4d5b7c;" style=" margin-top:0px; margin-bottom:0px; margin-left:72px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:24px;"><a href="https://www.digitalocean.com/community/tutorials"><span style=" font-size:medium; text-decoration: underline; color:#000000; background-color:transparent;">Учебники</span></a></li>
<li style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; font-weight:496; color:#4d5b7c;" style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:24px;"><a href="https://www.digitalocean.com/community/questions"><span style=" font-size:medium; text-decoration: underline; color:#000000; background-color:transparent;">Вопросы</span></a></li>
<li style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; font-weight:496; color:#4d5b7c;" style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:24px;"><a href="https://docs.digitalocean.com/"><span style=" font-size:medium; text-decoration: underline; color:#000000; background-color:transparent;">Документация по продукту</span></a></li>
<li style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><a name="communitysearch"></a><span style=" font-size:medium; color:#4d5b7c; background-color:#f9fafe;">П</span><span style=" font-size:medium; color:#4d5b7c; background-color:#f9fafe;">оиск сообщества</span></li></ul>
<p style=" margin-top:40px; margin-bottom:8px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:24px;"><span style=" font-family:'__JetBrains_Mono_26ed0d,monospace'; font-size:9pt; font-weight:600; color:#0069ff; text-transform:uppercase;">УЧЕБНИК</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:40px;"><span style=" font-family:'__Epilogue_61966b,sans-serif'; font-size:9pt; font-weight:600; color:#031b4e;">Как установить и защитить Mosquitto MQTT Messaging Broker в Ubuntu 18.04 [Краткое руководство]</span></p>
<p style=" margin-top:8px; margin-bottom:8px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:24px;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">Опубликовано 16 июля 2018 г.</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; font-weight:496; color:#333333;" style=" margin-top:0px; margin-bottom:0px; margin-left:72px; margin-right:72px; -qt-block-indent:0; text-indent:0px; line-height:1.6%;"><a href="https://www.digitalocean.com/community/tags/ubuntu"><span style=" font-size:medium; text-decoration: underline; color:#4d5b7c; background-color:#eff2fb;">Убунту</span></a></li>
<li style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; font-weight:496; color:#333333;" style=" margin-top:0px; margin-bottom:0px; margin-left:72px; margin-right:72px; -qt-block-indent:0; text-indent:0px; line-height:1.6%;"><a href="https://www.digitalocean.com/community/tags/messaging"><span style=" font-size:medium; text-decoration: underline; color:#4d5b7c; background-color:#eff2fb;">Обмен сообщениями</span></a></li>
<li style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; font-weight:496; color:#333333;" style=" margin-top:0px; margin-bottom:0px; margin-left:72px; margin-right:72px; -qt-block-indent:0; text-indent:0px; line-height:1.6%;"><a href="https://www.digitalocean.com/community/tags/miscellaneous"><span style=" font-size:medium; text-decoration: underline; color:#4d5b7c; background-color:#eff2fb;">Разнообразный</span></a></li>
<li style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; font-weight:496; color:#333333;" style=" margin-top:0px; margin-bottom:0px; margin-left:72px; margin-right:72px; -qt-block-indent:0; text-indent:0px; line-height:1.6%;"><a href="https://www.digitalocean.com/community/tags/quickstart"><span style=" font-size:medium; text-decoration: underline; color:#4d5b7c; background-color:#eff2fb;">Быстрый старт</span></a></li>
<li style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; font-weight:496; color:#333333;" style=" margin-top:0px; margin-bottom:0px; margin-left:72px; margin-right:72px; -qt-block-indent:0; text-indent:0px; line-height:1.6%;"><a href="https://www.digitalocean.com/community/tags/ubuntu-18-04"><span style=" font-size:medium; text-decoration: underline; color:#4d5b7c; background-color:#eff2fb;">Убунту 18.04</span></a></li></ul>
<p style=" margin-top:16px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><img src="image6163811.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:24px;"><a href="https://www.digitalocean.com/community/users/bboucheron"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; text-decoration: underline; color:#0069ff;">Брайан Бушерон</span></a><img src="image1141329733.png" /></p>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><a name="introduction"></a><a href="https://www.digitalocean.com/community/tutorials/how-to-install-and-secure-the-mosquitto-mqtt-messaging-broker-on-ubuntu-18-04-quickstart?_x_tr_sl=en&amp;_x_tr_tl=ru&amp;_x_tr_hl=ru&amp;_x_tr_pto=sc#introduction"><span style=" font-family:'__Epilogue_61966b,sans-serif'; font-size:9pt; font-weight:600; text-decoration: underline; color:#000000;">В</span></a><span style=" font-family:'__Epilogue_61966b,sans-serif'; font-size:9pt; font-weight:600; color:#000000;">ведение</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><a href="http://mqtt.org/"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; text-decoration: underline; color:#0069ff;">MQTT</span></a><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;"> — это протокол обмена сообщениями между машинами, разработанный для обеспечения легкой публикации/подписки для устройств «Интернета вещей». </span><a href="https://mosquitto.org/"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; text-decoration: underline; color:#0069ff;">Mosquitto</span></a><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;"> — это популярный сервер MQTT (или </span><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; font-style:italic; color:#4d5b7c;">брокер</span><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;"> , на языке MQTT), который имеет большую поддержку сообщества и прост в установке и настройке.</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">В этом кратком руководстве по быстрому старту мы установим и настроим Mosquitto и используем SSL-сертификаты Let's Encrypt для защиты нашего трафика MQTT. Если вам нужно более подробное освещение любого из шагов, пожалуйста, ознакомьтесь со следующими руководствами:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;" style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><a href="https://www.digitalocean.com/community/tutorials/how-to-use-certbot-standalone-mode-to-retrieve-let-s-encrypt-ssl-certificates-on-ubuntu-1804"><span style=" font-size:medium; text-decoration: underline; color:#0069ff;">Как использовать автономный режим Certbot для получения SSL-сертификатов Let's Encrypt</span></a></li>
<li style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;" style=" margin-top:0px; margin-bottom:26px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><a href="https://www.digitalocean.com/community/tutorials/how-to-install-and-secure-the-mosquitto-mqtt-messaging-broker-on-ubuntu-18-04"><span style=" font-size:medium; text-decoration: underline; color:#0069ff;">Как установить и защитить брокер сообщений Mosquitto MQTT</span></a></li></ul>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><a name="prerequisites"></a><a href="https://www.digitalocean.com/community/tutorials/how-to-install-and-secure-the-mosquitto-mqtt-messaging-broker-on-ubuntu-18-04-quickstart?_x_tr_sl=en&amp;_x_tr_tl=ru&amp;_x_tr_hl=ru&amp;_x_tr_pto=sc#prerequisites"><span style=" font-family:'__Epilogue_61966b,sans-serif'; font-size:9pt; font-weight:600; text-decoration: underline; color:#000000;">П</span></a><span style=" font-family:'__Epilogue_61966b,sans-serif'; font-size:9pt; font-weight:600; color:#000000;">редпосылки</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">Перед началом этого урока вам понадобится:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;" style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium;">Сервер Ubuntu 18.04 с пользователем без прав root, с включенной функцией sudo и базовой настройкой брандмауэра, как подробно описано в </span><a href="https://www.digitalocean.com/community/tutorials/initial-server-setup-with-ubuntu-18-04"><span style=" font-size:medium; text-decoration: underline; color:#0069ff;">этом руководстве по настройке сервера Ubuntu 18.04.</span></a></li>
<li style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;" style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace,monospace'; font-size:medium; color:#000000; background-color:rgba(255,192,1,0.294118);">mqtt.example.com</span><span style=" font-size:medium;">Доменное имя, указывающее на ваш сервер. В этом руководстве будет использоваться заполнитель</span></li>
<li style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;" style=" margin-top:0px; margin-bottom:26px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium;">Порт 80 на вашем сервере не должен использоваться. Если вы устанавливаете Mosquitto на машину с веб-сервером, который занимает этот порт, вам нужно будет использовать другой метод для получения сертификатов, например </span><a href="https://certbot.eff.org/docs/using.html#webroot"><span style=" font-size:medium; text-decoration: underline; color:#0069ff;">режим Certbot's </span></a><a href="https://certbot.eff.org/docs/using.html#webroot"><span style=" font-size:medium; font-style:italic; text-decoration: underline; color:#0069ff;">webroot</span></a><span style=" font-size:medium;"> .</span></li></ul>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><a name="step-1-installing-the-software"></a><a href="https://www.digitalocean.com/community/tutorials/how-to-install-and-secure-the-mosquitto-mqtt-messaging-broker-on-ubuntu-18-04-quickstart?_x_tr_sl=en&amp;_x_tr_tl=ru&amp;_x_tr_hl=ru&amp;_x_tr_pto=sc#step-1-installing-the-software"><span style=" font-family:'__Epilogue_61966b,sans-serif'; font-size:9pt; font-weight:600; text-decoration: underline; color:#000000;">Ш</span></a><span style=" font-family:'__Epilogue_61966b,sans-serif'; font-size:9pt; font-weight:600; color:#000000;">аг 1 — Установка программного обеспечения</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">Сначала мы установим пользовательский репозиторий программного обеспечения, чтобы получить последнюю версию Certbot, клиента Let's Encrypt:</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Courier New,courier'; font-size:9pt; color:#000000; background-color:#11192e;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; color:#ffaf8c;">sudo</span><span style=" font-size:medium;"> add-apt-repository ppa:certbot/certbot</span></li></ol>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:9pt; color:#ffffff; background-color:#696fb0;">Копировать</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">Нажмите </span><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#24335a; background-color:#e3e8f4;">ENTER</span><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">, чтобы принять, затем установите программные пакеты для Mosquitto и Certbot:</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Courier New,courier'; font-size:9pt; color:#000000; background-color:#11192e;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; color:#ffaf8c;">sudo</span><span style=" font-size:medium;"> </span><span style=" font-size:medium; color:#ffaf8c;">apt</span><span style=" font-size:medium;"> </span><span style=" font-size:medium; color:#ffaf8c;">install</span><span style=" font-size:medium;"> certbot mosquitto mosquitto-clients</span></li></ol>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:9pt; color:#ffffff; background-color:#696fb0;">Копировать</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">Далее мы получим наш SSL-сертификат.</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><a name="step-2-downloading-an-ssl-certificate"></a><a href="https://www.digitalocean.com/community/tutorials/how-to-install-and-secure-the-mosquitto-mqtt-messaging-broker-on-ubuntu-18-04-quickstart?_x_tr_sl=en&amp;_x_tr_tl=ru&amp;_x_tr_hl=ru&amp;_x_tr_pto=sc#step-2-downloading-an-ssl-certificate"><span style=" font-family:'__Epilogue_61966b,sans-serif'; font-size:9pt; font-weight:600; text-decoration: underline; color:#000000;">Ш</span></a><span style=" font-family:'__Epilogue_61966b,sans-serif'; font-size:9pt; font-weight:600; color:#000000;">аг 2 — Загрузка SSL-сертификата</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">Откройте порт </span><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#24335a; background-color:#e3e8f4;">80</span><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">в вашем брандмауэре:</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Courier New,courier'; font-size:9pt; color:#000000; background-color:#11192e;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; color:#ffaf8c;">sudo</span><span style=" font-size:medium;"> ufw allow </span><span style=" font-size:medium; color:#0be1ff;">80</span></li></ol>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:9pt; color:#ffffff; background-color:#696fb0;">Копировать</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">Затем запустите Certbot, чтобы получить сертификат. Не забудьте подставить здесь доменное имя вашего сервера:</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Courier New,courier'; font-size:9pt; color:#000000; background-color:#11192e;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; color:#ffaf8c;">sudo</span><span style=" font-size:medium;"> certbot certonly </span><span style=" font-size:medium; color:#b1e490;">--standalone</span><span style=" font-size:medium;"> --preferred-challenges http </span><span style=" font-size:medium; color:#b1e490;">-d</span><span style=" font-size:medium;"> </span><span style=" font-size:medium; background-color:#29334d;">mqtt.example.com</span></li></ol>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:9pt; color:#ffffff; background-color:#696fb0;">Копировать</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">Вам будет предложено ввести адрес электронной почты и согласиться с условиями обслуживания. После этого вы должны увидеть сообщение об успешном завершении процесса и о том, где хранятся ваши сертификаты.</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">Далее мы настроим Mosquitto для использования этих сертификатов.</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><a name="step-3-configuring-mosquitto"></a><a href="https://www.digitalocean.com/community/tutorials/how-to-install-and-secure-the-mosquitto-mqtt-messaging-broker-on-ubuntu-18-04-quickstart?_x_tr_sl=en&amp;_x_tr_tl=ru&amp;_x_tr_hl=ru&amp;_x_tr_pto=sc#step-3-configuring-mosquitto"><span style=" font-family:'__Epilogue_61966b,sans-serif'; font-size:9pt; font-weight:600; text-decoration: underline; color:#000000;">Ш</span></a><span style=" font-family:'__Epilogue_61966b,sans-serif'; font-size:9pt; font-weight:600; color:#000000;">аг 3 — Настройка Mosquitto</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">Сначала мы создадим файл паролей, который Mosquitto будет использовать для аутентификации подключений. Используйте </span><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#24335a; background-color:#e3e8f4;">mosquitto_passwd</span><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">для этого, убедившись, что заменили свое собственное предпочитаемое имя пользователя:</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Courier New,courier'; font-size:9pt; color:#000000; background-color:#11192e;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; color:#ffaf8c;">sudo</span><span style=" font-size:medium;"> mosquitto_passwd </span><span style=" font-size:medium; color:#b1e490;">-c</span><span style=" font-size:medium;"> /etc/mosquitto/passwd </span><span style=" font-size:medium; background-color:#29334d;">your-username</span></li></ol>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:9pt; color:#ffffff; background-color:#696fb0;">Копировать</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">Вам будет дважды предложено ввести пароль.</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">Теперь откройте новый файл конфигурации для Mosquitto:</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Courier New,courier'; font-size:9pt; color:#000000; background-color:#11192e;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; color:#ffaf8c;">sudo</span><span style=" font-size:medium;"> </span><span style=" font-size:medium; color:#ffaf8c;">nano</span><span style=" font-size:medium;"> /etc/mosquitto/conf.d/default.conf</span></li></ol>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:9pt; color:#ffffff; background-color:#696fb0;">Копировать</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">Откроется пустой файл. Вставьте следующее:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; background-color:#29334d;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#ffffff;">/etc/mosquitto/conf.d/default.conf</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; background-color:#11192e;"><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#000000;">allow_anonymous false</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; background-color:#11192e;"><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#000000;">password_file /etc/mosquitto/passwd</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; font-family:'monospace,monospace'; font-size:9pt; color:#000000; background-color:#11192e;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; background-color:#11192e;"><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#000000;">listener 1883 localhost</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; font-family:'monospace,monospace'; font-size:9pt; color:#000000; background-color:#11192e;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; background-color:#11192e;"><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#000000;">listener 8883</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; background-color:#11192e;"><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#000000;">certfile /etc/letsencrypt/live/</span><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#000000; background-color:#29334d;">mqtt.example.com</span><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#000000;">/cert.pem</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; background-color:#11192e;"><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#000000;">cafile /etc/letsencrypt/live/</span><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#000000; background-color:#29334d;">mqtt.example.com</span><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#000000;">/chain.pem</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; background-color:#11192e;"><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#000000;">keyfile /etc/letsencrypt/live/</span><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#000000; background-color:#29334d;">mqtt.example.com</span><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#000000;">/privkey.pem</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; font-family:'monospace,monospace'; font-size:9pt; color:#000000; background-color:#11192e;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; background-color:#11192e;"><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#000000;">listener 8083</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; background-color:#11192e;"><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#000000;">protocol websockets</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; background-color:#11192e;"><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#000000;">certfile /etc/letsencrypt/live/</span><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#000000; background-color:#29334d;">mqtt.example.com</span><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#000000;">/cert.pem</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; background-color:#11192e;"><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#000000;">cafile /etc/letsencrypt/live/</span><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#000000; background-color:#29334d;">mqtt.example.com</span><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#000000;">/chain.pem</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; background-color:#11192e;"><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#000000;">keyfile /etc/letsencrypt/live/</span><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#000000; background-color:#29334d;">mqtt.example.com</span><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#000000;">/privkey.pem</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; font-family:'monospace,monospace'; font-size:9pt; color:#000000; background-color:#11192e;"><br /></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">Обязательно замените доменное имя, которое вы использовали в Шаге 2, на </span><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#000000; background-color:rgba(255,192,1,0.294118);">mqtt.example.com</span><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">. Сохраните и закройте файл, когда закончите.</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">Этот файл выполняет следующие действия:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;" style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium;">Отключает анонимные входы</span></li>
<li style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;" style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium;">Использует наш файл паролей для включения аутентификации по паролю</span></li>
<li style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;" style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium;">Устанавливает незащищенный прослушиватель на порту 1883 только для </span><span style=" font-size:medium; font-weight:600;">локального хоста</span></li>
<li style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;" style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium;">Устанавливает безопасный прослушиватель на порту</span><span style=" font-family:'monospace,monospace'; font-size:medium; color:#24335a; background-color:#e3e8f4;">8883</span></li>
<li style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;" style=" margin-top:0px; margin-bottom:26px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium;">Устанавливает защищенный прослушиватель на основе веб-сокетов на порту</span><span style=" font-family:'monospace,monospace'; font-size:medium; color:#24335a; background-color:#e3e8f4;">8083</span></li></ul>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">Перезапустите Mosquitto, чтобы изменения конфигурации вступили в силу:</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Courier New,courier'; font-size:9pt; color:#000000; background-color:#11192e;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; color:#ffaf8c;">sudo</span><span style=" font-size:medium;"> systemctl restart mosquitto</span></li></ol>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:9pt; color:#ffffff; background-color:#696fb0;">Копировать</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">Проверьте, запущена ли служба снова:</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Courier New,courier'; font-size:9pt; color:#000000; background-color:#11192e;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; color:#ffaf8c;">sudo</span><span style=" font-size:medium;"> systemctl status mosquitto</span></li></ol>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:9pt; color:#ffffff; background-color:#696fb0;">Копировать</span></p>
<p style=" margin-top:15px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#11192e;"><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#9fddff;">Output</span><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#000000;">● mosquitto.service - LSB: mosquitto MQTT v3.1 message broker</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#11192e;"><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#000000;">   Loaded: loaded (/etc/init.d/mosquitto; generated)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#11192e;"><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#000000;">   Active: </span><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#000000; background-color:#29334d;">active (running)</span><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#000000;"> since Mon 2018-07-16 15:03:42 UTC; 2min 39s ago</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#11192e;"><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#000000;">     Docs: man:systemd-sysv-generator(8)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#11192e;"><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#000000;">  Process: 6683 ExecStop=/etc/init.d/mosquitto stop (code=exited, status=0/SUCCESS)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#11192e;"><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#000000;">  Process: 6699 ExecStart=/etc/init.d/mosquitto start (code=exited, status=0/SUCCESS)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#11192e;"><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#000000;">    Tasks: 1 (limit: 1152)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#11192e;"><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#000000;">   CGroup: /system.slice/mosquitto.service</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#11192e;"><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#000000;">           └─6705 /usr/sbin/mosquitto -c /etc/mosquitto/mosquitto.conf</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:4px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace,monospace'; font-size:9pt; color:#000000; background-color:#11192e;"><br /></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">Статус должен быть </span><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#24335a; background-color:#e3e8f4;">active (running)</span><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">. Если это не так, проверьте файл конфигурации и перезапустите снова. Дополнительная информация может быть доступна в файле журнала Mosquitto:</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Courier New,courier'; font-size:9pt; color:#000000; background-color:#11192e;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; color:#ffaf8c;">sudo</span><span style=" font-size:medium;"> </span><span style=" font-size:medium; color:#ffaf8c;">tail</span><span style=" font-size:medium;"> /var/log/mosquitto/mosquitto.log</span></li></ol>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:9pt; color:#ffffff; background-color:#696fb0;">Копировать</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">Если все в порядке, используйте команду </span><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#24335a; background-color:#e3e8f4;">ufw</span><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">, чтобы разрешить двум новым портам проходить через брандмауэр:</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Courier New,courier'; font-size:9pt; color:#000000; background-color:#11192e;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; color:#ffaf8c;">sudo</span><span style=" font-size:medium;"> ufw allow </span><span style=" font-size:medium; color:#0be1ff;">8883</span></li>
<li style=" font-family:'Courier New,courier'; font-size:9pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; color:#ffaf8c;">sudo</span><span style=" font-size:medium;"> ufw allow </span><span style=" font-size:medium; color:#0be1ff;">8083</span></li></ol>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:9pt; color:#ffffff; background-color:#696fb0;">Копировать</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">Теперь, когда Mosquitto настроен, мы настроим Certbot для перезапуска Mosquitto после обновления наших сертификатов.</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><a name="step-4-configuring-certbot-renewals"></a><a href="https://www.digitalocean.com/community/tutorials/how-to-install-and-secure-the-mosquitto-mqtt-messaging-broker-on-ubuntu-18-04-quickstart?_x_tr_sl=en&amp;_x_tr_tl=ru&amp;_x_tr_hl=ru&amp;_x_tr_pto=sc#step-4-configuring-certbot-renewals"><span style=" font-family:'__Epilogue_61966b,sans-serif'; font-size:9pt; font-weight:600; text-decoration: underline; color:#000000;">Ш</span></a><span style=" font-family:'__Epilogue_61966b,sans-serif'; font-size:9pt; font-weight:600; color:#000000;">аг 4 — Настройка продлений Certbot</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">Certbot автоматически обновит наши SSL-сертификаты до истечения срока их действия, но после этого ему необходимо указать, что необходимо перезапустить службу Mosquitto.</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">Откройте файл конфигурации продления Certbot для вашего доменного имени:</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Courier New,courier'; font-size:9pt; color:#000000; background-color:#11192e;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; color:#ffaf8c;">sudo</span><span style=" font-size:medium;"> </span><span style=" font-size:medium; color:#ffaf8c;">nano</span><span style=" font-size:medium;"> /etc/letsencrypt/renewal/</span><span style=" font-size:medium; background-color:#29334d;">mqtt.example.com</span><span style=" font-size:medium;">.conf</span></li></ol>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:9pt; color:#ffffff; background-color:#696fb0;">Копировать</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">Добавьте следующую </span><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#24335a; background-color:#e3e8f4;">renew_hook</span><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">опцию в последнюю строку:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; background-color:#29334d;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#ffffff;">/etc/letsencrypt/renewal/mqtt.example.com.conf</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; background-color:#11192e;"><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#000000;">renew_hook = systemctl restart mosquitto</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; font-family:'monospace,monospace'; font-size:9pt; color:#000000; background-color:#11192e;"><br /></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">Сохраните и закройте файл, затем выполните тестовый прогон Certbot, чтобы убедиться в правильности синтаксиса:</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Courier New,courier'; font-size:9pt; color:#000000; background-color:#11192e;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; color:#ffaf8c;">sudo</span><span style=" font-size:medium;"> certbot renew --dry-run</span></li></ol>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:9pt; color:#ffffff; background-color:#696fb0;">Копировать</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">Если вы не видите ошибок, все готово. Давайте теперь протестируем наш сервер MQTT.</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><a name="step-5-testing-mosquitto"></a><a href="https://www.digitalocean.com/community/tutorials/how-to-install-and-secure-the-mosquitto-mqtt-messaging-broker-on-ubuntu-18-04-quickstart?_x_tr_sl=en&amp;_x_tr_tl=ru&amp;_x_tr_hl=ru&amp;_x_tr_pto=sc#step-5-testing-mosquitto"><span style=" font-family:'__Epilogue_61966b,sans-serif'; font-size:9pt; font-weight:600; text-decoration: underline; color:#000000;">Ш</span></a><span style=" font-family:'__Epilogue_61966b,sans-serif'; font-size:9pt; font-weight:600; color:#000000;">аг 5 – Тестирование Mosquitto</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">На шаге 1 мы установили несколько клиентов командной строки MQTT. Мы можем подписаться на тему </span><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; font-weight:600; color:#4d5b7c;">test</span><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;"> на прослушивателе localhost следующим образом:</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Courier New,courier'; font-size:9pt; color:#000000; background-color:#11192e;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium;">mosquitto_sub </span><span style=" font-size:medium; color:#b1e490;">-h</span><span style=" font-size:medium;"> localhost </span><span style=" font-size:medium; color:#b1e490;">-t</span><span style=" font-size:medium;"> </span><span style=" font-size:medium; color:#ffaf8c; background-color:#29334d;">test</span><span style=" font-size:medium;"> </span><span style=" font-size:medium; color:#b1e490;">-u</span><span style=" font-size:medium;"> </span><span style=" font-size:medium; color:#b1e490;">&quot;</span><span style=" font-size:medium; background-color:#29334d;">your-user</span><span style=" font-size:medium; color:#b1e490;">&quot;</span><span style=" font-size:medium;"> </span><span style=" font-size:medium; color:#b1e490;">-P</span><span style=" font-size:medium;"> </span><span style=" font-size:medium; color:#b1e490;">&quot;</span><span style=" font-size:medium; background-color:#29334d;">your-password</span><span style=" font-size:medium; color:#b1e490;">&quot;</span></li></ol>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:9pt; color:#ffffff; background-color:#696fb0;">Копировать</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">И мы можем опубликовать с помощью </span><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#24335a; background-color:#e3e8f4;">mosquitto_pub</span><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">:</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Courier New,courier'; font-size:9pt; color:#000000; background-color:#11192e;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium;">mosquitto_pub </span><span style=" font-size:medium; color:#b1e490;">-h</span><span style=" font-size:medium;"> localhost </span><span style=" font-size:medium; color:#b1e490;">-t</span><span style=" font-size:medium;"> </span><span style=" font-size:medium; color:#ffaf8c; background-color:#29334d;">test</span><span style=" font-size:medium;"> </span><span style=" font-size:medium; color:#b1e490;">-m</span><span style=" font-size:medium;"> </span><span style=" font-size:medium; color:#b1e490;">&quot;</span><span style=" font-size:medium; background-color:#29334d;">hello world</span><span style=" font-size:medium; color:#b1e490;">&quot;</span><span style=" font-size:medium;"> </span><span style=" font-size:medium; color:#b1e490;">-u</span><span style=" font-size:medium;"> </span><span style=" font-size:medium; color:#b1e490;">&quot;</span><span style=" font-size:medium; background-color:#29334d;">your-user</span><span style=" font-size:medium; color:#b1e490;">&quot;</span><span style=" font-size:medium;"> </span><span style=" font-size:medium; color:#b1e490;">-P</span><span style=" font-size:medium;"> </span><span style=" font-size:medium; color:#b1e490;">&quot;</span><span style=" font-size:medium; background-color:#29334d;">your-password</span><span style=" font-size:medium; color:#b1e490;">&quot;</span></li></ol>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:9pt; color:#ffffff; background-color:#696fb0;">Копировать</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">Чтобы подписаться с помощью защищенного прослушивателя на порту 8883, выполните следующие действия:</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Courier New,courier'; font-size:9pt; color:#000000; background-color:#11192e;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium;">mosquitto_sub </span><span style=" font-size:medium; color:#b1e490;">-h</span><span style=" font-size:medium;"> </span><span style=" font-size:medium; background-color:#29334d;">mqtt.example.com</span><span style=" font-size:medium;"> </span><span style=" font-size:medium; color:#b1e490;">-t</span><span style=" font-size:medium;"> </span><span style=" font-size:medium; color:#ffaf8c; background-color:#29334d;">test</span><span style=" font-size:medium;"> </span><span style=" font-size:medium; color:#b1e490;">-p</span><span style=" font-size:medium;"> </span><span style=" font-size:medium; color:#0be1ff;">8883</span><span style=" font-size:medium;"> </span><span style=" font-size:medium; color:#b1e490;">--capath</span><span style=" font-size:medium;"> /etc/ssl/certs/ </span><span style=" font-size:medium; color:#b1e490;">-u</span><span style=" font-size:medium;"> </span><span style=" font-size:medium; color:#b1e490;">&quot;</span><span style=" font-size:medium; background-color:#29334d;">your-username</span><span style=" font-size:medium; color:#b1e490;">&quot;</span><span style=" font-size:medium;"> </span><span style=" font-size:medium; color:#b1e490;">-P</span><span style=" font-size:medium;"> </span><span style=" font-size:medium; color:#b1e490;">&quot;</span><span style=" font-size:medium; background-color:#29334d;">your-password</span><span style=" font-size:medium; color:#b1e490;">&quot;</span></li></ol>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:9pt; color:#ffffff; background-color:#696fb0;">Копировать</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">И вот как вы публикуете данные для защищенного слушателя:</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Courier New,courier'; font-size:9pt; color:#000000; background-color:#11192e;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium;">mosquitto_pub </span><span style=" font-size:medium; color:#b1e490;">-h</span><span style=" font-size:medium;"> </span><span style=" font-size:medium; background-color:#29334d;">mqtt.example.com</span><span style=" font-size:medium;"> </span><span style=" font-size:medium; color:#b1e490;">-t</span><span style=" font-size:medium;"> </span><span style=" font-size:medium; color:#ffaf8c; background-color:#29334d;">test</span><span style=" font-size:medium;"> </span><span style=" font-size:medium; color:#b1e490;">-m</span><span style=" font-size:medium;"> </span><span style=" font-size:medium; color:#b1e490;">&quot;</span><span style=" font-size:medium; background-color:#29334d;">hello world</span><span style=" font-size:medium; color:#b1e490;">&quot;</span><span style=" font-size:medium;"> </span><span style=" font-size:medium; color:#b1e490;">-p</span><span style=" font-size:medium;"> </span><span style=" font-size:medium; color:#0be1ff;">8883</span><span style=" font-size:medium;"> </span><span style=" font-size:medium; color:#b1e490;">--capath</span><span style=" font-size:medium;"> /etc/ssl/certs/ </span><span style=" font-size:medium; color:#b1e490;">-u</span><span style=" font-size:medium;"> </span><span style=" font-size:medium; color:#b1e490;">&quot;</span><span style=" font-size:medium; background-color:#29334d;">your-username</span><span style=" font-size:medium; color:#b1e490;">&quot;</span><span style=" font-size:medium;"> </span><span style=" font-size:medium; color:#b1e490;">-P</span><span style=" font-size:medium;"> </span><span style=" font-size:medium; color:#b1e490;">&quot;</span><span style=" font-size:medium; background-color:#29334d;">your-password</span><span style=" font-size:medium; color:#b1e490;">&quot;</span></li></ol>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:9pt; color:#ffffff; background-color:#696fb0;">Копировать</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">Обратите внимание, что мы используем полное имя хоста вместо </span><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#24335a; background-color:#e3e8f4;">localhost</span><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">. Поскольку наш SSL-сертификат выпущен для </span><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#000000; background-color:rgba(255,192,1,0.294118);">mqtt.example.com</span><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">, при попытке безопасного подключения к </span><span style=" font-family:'monospace,monospace'; font-size:9pt; color:#24335a; background-color:#e3e8f4;">localhost</span><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">мы получим сообщение об ошибке, сообщающее, что имя хоста не соответствует имени хоста сертификата.</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">Для проверки функциональности веб-сокета мы будем использовать публичный клиент MQTT на основе браузера. </span><a href="https://www.eclipse.org/paho/clients/js/utility/"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; text-decoration: underline; color:#0069ff;">Откройте утилиту клиента Eclipse Paho javascript в вашем браузере</span></a><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;"> и заполните информацию о подключении следующим образом:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;" style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Хост</span><span style=" font-size:medium;"> — это домен вашего сервера Mosquitto,</span><span style=" font-family:'monospace,monospace'; font-size:medium; color:#000000; background-color:rgba(255,192,1,0.294118);">mqtt.example.com</span></li>
<li style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;" style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Порт</span><span style=" font-size:medium;"> есть</span><span style=" font-family:'monospace,monospace'; font-size:medium; color:#24335a; background-color:#e3e8f4;">8083</span></li>
<li style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;" style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">ClientId</span><span style=" font-size:medium;"> можно оставить со случайным значением по умолчанию.</span></li>
<li style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;" style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Путь</span><span style=" font-size:medium;"> можно оставить по умолчанию </span><span style=" font-size:medium; font-weight:600;">/ws</span></li>
<li style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;" style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Имя пользователя</span><span style=" font-size:medium;"> — это ваше имя пользователя Mosquitto из Шага 3.</span></li>
<li style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;" style=" margin-top:0px; margin-bottom:26px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Пароль</span><span style=" font-size:medium;"> — это пароль, который вы выбрали на шаге 3.</span></li></ul>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">Остальные поля можно оставить со значениями по умолчанию.</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">После нажатия </span><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; font-weight:600; color:#4d5b7c;">Connect</span><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;"> клиент подключится к вашему серверу. Вы можете публиковать и подписываться, используя панели </span><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; font-weight:600; color:#4d5b7c;">Subscribe</span><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;"> и </span><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; font-weight:600; color:#4d5b7c;">Publish Message</span><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;"> под панелью </span><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; font-weight:600; color:#4d5b7c;">Connection</span><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;"> .</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><a name="conclusion"></a><a href="https://www.digitalocean.com/community/tutorials/how-to-install-and-secure-the-mosquitto-mqtt-messaging-broker-on-ubuntu-18-04-quickstart?_x_tr_sl=en&amp;_x_tr_tl=ru&amp;_x_tr_hl=ru&amp;_x_tr_pto=sc#conclusion"><span style=" font-family:'__Epilogue_61966b,sans-serif'; font-size:9pt; font-weight:600; text-decoration: underline; color:#000000;">З</span></a><span style=" font-family:'__Epilogue_61966b,sans-serif'; font-size:9pt; font-weight:600; color:#000000;">аключение</span></p>
<p style=" margin-top:15px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">Мы уже настроили и протестировали безопасный, защищенный паролем и зашифрованный SSL сервер MQTT. Он может служить надежной и безопасной платформой обмена сообщениями для вашего IoT, домашней автоматизации или других проектов.</span></p>
<p style=" margin-top:32px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">Спасибо за обучение в сообществе DigitalOcean. Ознакомьтесь с нашими предложениями по вычислениям, хранению, сетевым технологиям и управляемым базам данных.</span></p>
<p style=" margin-top:15px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><a href="https://www.digitalocean.com/products"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; text-decoration: underline; color:#0069ff;">Узнайте больше о нашей продукции</span></a></p>
<p style=" margin-top:50px; margin-bottom:0px; margin-left:72px; margin-right:72px; -qt-block-indent:0; text-indent:0px; line-height:32px; background-color:rgba(200,223,255,0.4);"><span style=" font-family:'__Epilogue_61966b,sans-serif'; font-size:9pt; font-weight:600; color:#081b4b;">Об авторах</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:72px; margin-right:72px; -qt-block-indent:0; text-indent:0px;"><img src="image1785586843.png" /></p>
<p style=" margin-top:4px; margin-bottom:4px; margin-left:72px; margin-right:72px; -qt-block-indent:0; text-indent:0px; line-height:26px;"><a href="https://www.digitalocean.com/community/users/bboucheron"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; font-weight:496; text-decoration: underline; color:#0069ff; background-color:transparent;">Брайан Бушерон</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:80px; margin-right:80px; -qt-block-indent:0; text-indent:0px; line-height:24px; background-color:#98dfdc;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; font-weight:496; color:#081b4b;">Автор</span></p>
<p style=" margin-top:40px; margin-bottom:0px; margin-left:72px; margin-right:72px; -qt-block-indent:0; text-indent:0px; line-height:28px; background-color:#ffffff;"><span style=" font-family:'__Epilogue_61966b,sans-serif'; font-size:9pt; font-weight:496; color:#081b4b;">Все еще ищете ответ?</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://www.digitalocean.com/community/questions"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; font-weight:600; text-decoration: underline; color:#24335a; background-color:transparent;">Задать вопрос</span></a><a href="https://www.digitalocean.com/community"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; font-weight:600; text-decoration: underline; color:#24335a; background-color:transparent;">Поиск дополнительной помощи</span></a></p>
<hr />
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:28px;"><span style=" font-family:'__Epilogue_61966b,sans-serif'; font-size:9pt; font-weight:496; color:#081b4b;">Было ли это полезно?</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:9pt; font-weight:600; color:#24335a; background-color:transparent;">ДаНет</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:44px; margin-right:44px; -qt-block-indent:0; text-indent:0px; background-color:#e3e8f4;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#000000; background-color:#e3e8f4;"> </span></p>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:9pt; font-weight:496; color:#031b4e;">Комментарии</span></p>
<p style=" margin-top:0px; margin-bottom:16px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:32px;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; font-weight:600; color:#081b4b;">4 комментария</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.5%; background-color:#eff2fb;"><a name="a"></a><span style=" font-family:'__JetBrains_Mono_26ed0d,monospace'; font-size:9pt; color:#000000;">О</span><span style=" font-family:'__JetBrains_Mono_26ed0d,monospace'; font-size:9pt; color:#000000;">ставьте комментарий...﻿<br /></span></p>
<p style=" margin-top:20px; margin-bottom:16px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#8a96b5;">В этом текстовом поле по умолчанию для форматирования ответа используется </span><span style=" font-family:'__JetBrains_Mono_26ed0d,monospace'; font-size:9pt; font-weight:696; color:#4d5b7c;">Markdown .</span></p>
<p style=" margin-top:0px; margin-bottom:16px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#8a96b5;">Вы можете ввести </span><span style=" font-family:'__JetBrains_Mono_26ed0d,monospace'; font-size:9pt; font-weight:696; color:#4d5b7c;">!ref</span><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#8a96b5;"> в этом текстовом поле, чтобы быстро найти наш полный набор учебных пособий, документации и предложений на торговой площадке, а затем вставить ссылку!</span></p>
<p style=" margin-top:5px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><a href="https://www.digitalocean.com/api/dynamic-content/v1/login?success_redirect=https%3A%2F%2Fwww.digitalocean.com%2Fcommunity%2Ftutorials%2Fhow-to-install-and-secure-the-mosquitto-mqtt-messaging-broker-on-ubuntu-18-04-quickstart%3F_x_tr_sl%3Den%26_x_tr_tl%3Dru%26_x_tr_hl%3Dru%26_x_tr_pto%3Dsc&amp;error_redirect=https%3A%2F%2Fwww.digitalocean.com%2Fauth-error&amp;type=register"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; font-weight:600; text-decoration: underline; color:#ffffff; background-color:#0069ff;">Войдите или зарегистрируйтесь, чтобы оставить комментарий</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:72px; -qt-block-indent:0; text-indent:0px; line-height:1.5%; background-color:#ffffff;"><a href="https://www.digitalocean.com/community/users/demothi"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; font-weight:496; text-decoration: underline; color:#0069ff; background-color:transparent;">Демоти</span></a><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">•</span><a href="https://www.digitalocean.com/community/tutorials/how-to-install-and-secure-the-mosquitto-mqtt-messaging-broker-on-ubuntu-18-04-quickstart?comment=74758"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; text-decoration: underline; color:#000000; background-color:transparent;">2 ноября 2018 г.</span></a></p>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">При работе с сертификацией я столкнулся с несколькими ошибками.</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">Команда: sudo certbot certonly --standalone --preferred-challenges http -d </span><a href="http://mqtt.example.com/"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; text-decoration: underline; color:#0069ff;">mqtt.example.com</span></a><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;"> Ошибка: Проблема привязки к порту 80: Не удалось привязаться к IPv4 или IPv6.</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">Команда: sudo certbot renew --dry-run Ошибки: Попытка обновить сертификат ( </span><a href="http://mqtt.example.com/"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; text-decoration: underline; color:#0069ff;">mqtt.example.com</span></a><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;"> ) из /etc/letsencrypt/renewal/mqtt.example.com.conf привела к непредвиденной ошибке: Проблема привязки к порту 80: Не удалось привязать к IPv4 или IPv6… Пропуск. Пробный запуск: пропуск команды deploy hook: systemctl restart mosquitto</span></p>
<p style=" margin-top:15px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">Вам нужно остановить веб-сервис. Для меня это было «service apache2 stop»</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;" style=" margin-top:24px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:medium; text-decoration: underline; color:#0069ff;">Отвечать</span></li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:72px; -qt-block-indent:0; text-indent:0px; line-height:1.5%; background-color:#ffffff;"><a href="https://www.digitalocean.com/community/users/guilleb"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; font-weight:496; text-decoration: underline; color:#0069ff; background-color:transparent;">гильеб</span></a><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">•</span><a href="https://www.digitalocean.com/community/tutorials/how-to-install-and-secure-the-mosquitto-mqtt-messaging-broker-on-ubuntu-18-04-quickstart?comment=99446"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; text-decoration: underline; color:#000000; background-color:transparent;">28 июня 2021 г.</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">Все работает отлично, за исключением клиента Eclipse Paho javascript. Кнопка «Подключиться» выдает ошибку на консоли javascript: Uncaught ReferenceError: connectionToggle is not defined И, очевидно, соединение не происходит.</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;" style=" margin-top:24px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:medium; text-decoration: underline; color:#0069ff;">Отвечать</span></li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:72px; -qt-block-indent:0; text-indent:0px; line-height:1.5%; background-color:#ffffff;"><a href="https://www.digitalocean.com/community/users/dkiwi"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; font-weight:496; text-decoration: underline; color:#0069ff; background-color:transparent;">дкиви</span></a><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">•</span><a href="https://www.digitalocean.com/community/tutorials/how-to-install-and-secure-the-mosquitto-mqtt-messaging-broker-on-ubuntu-18-04-quickstart?comment=79999"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; text-decoration: underline; color:#000000; background-color:transparent;">14 июня 2019 г.</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">Все работает гладко, за исключением того, что я не могу подключиться безопасно через порт 8883. Я получаю сообщение «Ошибка: произошла ошибка TLS». Он работает через 1883, используя домен, но не 8883. /etc/ssl/certs/ пуст, должно ли здесь что-то быть?</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;" style=" margin-top:24px; margin-bottom:0px; margin-left:36px; margin-right:52px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:medium; text-decoration: underline; color:#0069ff;">Показать ответы</span></li>
<li style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;" style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:medium; text-decoration: underline; color:#0069ff;">Отвечать</span></li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:72px; -qt-block-indent:0; text-indent:0px; line-height:1.5%; background-color:#ffffff;"><a href="https://www.digitalocean.com/community/users/alex183e2b69d92"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; font-weight:496; text-decoration: underline; color:#0069ff; background-color:transparent;">alex183e2b69d92</span></a><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">•</span><a href="https://www.digitalocean.com/community/tutorials/how-to-install-and-secure-the-mosquitto-mqtt-messaging-broker-on-ubuntu-18-04-quickstart?comment=76367"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; text-decoration: underline; color:#000000; background-color:transparent;">9 января 2019 г.</span></a></p>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">При обновлении сертификатов SSL команды перезапуска Mosquitto не выполняются, поскольку они не дожидаются повторного запуска процесса, вам необходимо использовать (не самый чистый способ перезапуска, но он хотя бы работает…)</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">renew_hook = systemctl остановить mosquitto;спящий режим 1;systemctl запустить mosquitto</span></p>
<p style=" margin-top:15px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:1.5%;"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;">команды сна делают здесь магию. Если вы найдете другой способ сделать это, пожалуйста, поделитесь им.</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;" style=" margin-top:24px; margin-bottom:0px; margin-left:36px; margin-right:52px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:medium; text-decoration: underline; color:#0069ff;">Показать ответы</span></li>
<li style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; color:#4d5b7c;" style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:medium; text-decoration: underline; color:#0069ff;">Отвечать</span></li></ul>
<p style=" margin-top:10px; margin-bottom:72px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:22px;"><img src="image1686577049.png" /><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><span style=" font-family:'__Inter_1fc7a2,sans-serif'; font-size:9pt; text-decoration: underline; color:#535772; background-color:transparent;">Данная работа лицензирована в соответствии с лицензией Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International.</span></a></p></body></html>