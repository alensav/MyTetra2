<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:24px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:xx-large; color:#333333; vertical-align:middle;">Настройка фаервола в Ubuntu с помощью утилиты UFW</span></p>
<p style=" margin-top:0px; margin-bottom:30px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image253198945.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://community.vscale.io/hc/ru/profiles/5584242425-Alexander-Kozhevin"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; text-decoration: underline; color:#1c98d3; background-color:transparent; vertical-align:middle;">Alexander Kozhevin</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:13px; font-weight:296; color:#666666; vertical-align:middle;">9 октябрь 2016 г. 18:53</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.6%;"><img src="image2062005536.png" /><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:x-large; color:#333333;"><br />Введение</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">UFW (Uncomplicated Firewall - несложный фаервол) -  удобный интерфейс для управления политиками безопасности </span><a href="http://help.ubuntu.ru/wiki/firewall"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; text-decoration: underline; color:#105779; background-color:transparent;">межсетевого экрана.</span></a><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;"> Наши серверы постоянно подвергаются различным атакам или сканируются в поиске уязвимостей. Как только эти уязвимости находятся, мы рискуем стать частью ботнета, раскрыть конфиденциальные данные или потерять деньги из-за сбоев в работе веб-приложений. Одной из первых мер по снижению рисков безопасности является грамотная настройка правил межсетевого экрана. В нашем руководстве мы рассмотрим основные команды и правила работы с утилитой UFW.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;"> </span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:x-large; color:#333333;">Предварительные требования</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;" style=" margin-top:20px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:15px;">Для начала работы с UFW вам потребуется суперпользователь(возможность исполнения команд под </span><span style=" font-size:15px; font-weight:600;">sudo</span><span style=" font-size:15px;">).  </span></li>
<li style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;" style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:15px;">Утилита  UFW предустановлена в системе. Если по какой-то причине она была отсутствует, вы можете установить ее  с помощью команды:</span></li></ol>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:1; text-indent:0px; background-color:#f8f8f8;"><span style=" font-family:'monospace,monospace'; font-size:15px; color:#333333; background-color:#f8f8f8;">sudo apt-get install ufw</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:x-large; color:#333333;"> </span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:x-large; color:#333333;">Проверка правил и текущего состояния UFW<br /><br /></span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">В любое время вы можете проверить состояние UFW с помощью команды:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f8f8;"><span style=" font-family:'monospace,monospace'; font-size:15px; color:#333333; background-color:#f8f8f8;">sudo ufw status verbose</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">По умолчанию UFW отключен, так что вы должны увидеть что-то вроде этого:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f8f8;"><span style=" font-family:'monospace,monospace'; font-size:15px; color:#333333;">Status: inactive</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">Если UFW включен, то в консоли будут перечисляться заданные правила. Например, если firewall настроен таким образом - SSH (порт 22) соединение из любой точки мира, консоль может выглядеть следующим образом:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f8f8;"><span style=" font-family:'monospace,monospace'; font-size:15px; color:#333333;">Status: active<br /><br />Logging: on (low)<br /><br />Default: deny (incoming), allow (outgoing), disabled (routed)<br /><br />New profiles: skip<br /><br /> <br /><br />To                         Action      From<br /><br />--                         ------      ----<br /><br />22                         ALLOW IN    Anywhere<br /><br />22 (v6)                    ALLOW IN    Anywhere (v6)<br /><br /> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">Так вы всегда можете узнать как настроен фаервол. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; font-weight:600; color:#333333;">Внимание!</span><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;"> Проведите начальную настройку перед включением UFW. В частности, должен быть доступен SSH(22 порт). В ином случае вы рискуете потерять доступ к серверу.</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:x-large; color:#333333;"> </span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:x-large; color:#333333;">Начальная настройка</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">По умолчанию UFW настройки запрещают все входящие соединения и разрешают все исходящие. Это значит, что если кто-то попытается  достичь ваш сервер, он не сможет подключиться, в то время как любое приложение на сервере имеет доступ к внешним соединениям.<br /><br />Cоответствующие правила фаервола прописываются так:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f8f8;"><span style=" font-family:'monospace,monospace'; font-size:15px; color:#333333; background-color:#f8f8f8;">sudo ufw default deny incoming</span><span style=" font-family:'monospace,monospace'; font-size:15px; color:#333333;"><br /><br />sudo ufw default allow outgoing</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;"> </span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:x-large; color:#333333;">Добавление правила для SSH-соединений</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;"> Чтобы разрешить входящие SSH-соединения, выполните команду:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f8f8;"><span style=" font-family:'monospace,monospace'; font-size:15px; color:#333333; background-color:#f8f8f8;">sudo ufw allow ssh</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">SSH демон прослушивает 22 порт. UFW знает об именах распространенных служб (ssh, sftp, http, https), поэтому вы можете использовать их вместо номера порта.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">Если ваш SSH-демон использует другой порт, вам необходимо указать его в явном виде, например:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f8f8;"><span style=" font-family:'monospace,monospace'; font-size:15px; color:#333333; background-color:#f8f8f8;">sudo ufw allow 2222</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">Теперь, когда ваш межсетевой экран настроен, можете включать его.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;"> </span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:x-large; color:#333333;">Запуск UFW</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">Чтобы включить UFW, используйте следующую команду:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f8f8;"><span style=" font-family:'monospace,monospace'; font-size:15px; color:#333333; background-color:#f8f8f8;">sudo ufw enable</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">Вы получите похожее  предупреждение:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f8f8;"><span style=" font-family:'monospace,monospace'; font-size:15px; color:#333333; background-color:#f8f8f8;">Command may disrupt existing ssh connections. Proceed with operation (y|n)? </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">Это означает, что запуск этого сервиса может разорвать текущее ssh соединение. <br />Но, так как мы его уже добавили ssh в правила, этого не произойдет. Поэтому просто нажмите (y).</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;"> </span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:x-large; color:#333333;">Добавление правил для других подключений</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;"><br />Чтобы ваши приложения работали корректно, вам необходимо добавить другие правила. Ниже будут  показаны настроить для наиболее распространённых служб.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;"> </span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:x-large; color:#333333;">HTTP (80 порт)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">Для работы не зашифрованных веб-серверов используйте следующую команду:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f8f8;"><span style=" font-family:'monospace,monospace'; font-size:15px; color:#333333; background-color:#f8f8f8;">sudo ufw allow http</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">Или</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f8f8;"><span style=" font-family:'monospace,monospace'; font-size:15px; color:#333333; background-color:#f8f8f8;">sudo ufw allow 80</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:x-large; color:#333333;">HTTPS (443 порт)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">То же самое, что и в предыдущем примере, но для зашифрованных соединений:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f8f8;"><span style=" font-family:'monospace,monospace'; font-size:15px; color:#333333; background-color:#f8f8f8;">sudo ufw allow https</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">Или</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f8f8;"><span style=" font-family:'monospace,monospace'; font-size:15px; color:#333333; background-color:#f8f8f8;">sudo ufw allow 443</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:x-large; color:#333333;">FTP (21 порт)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">Данный порт используется для незашифрованной передачи файлов:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f8f8;"><span style=" font-family:'monospace,monospace'; font-size:15px; color:#333333; background-color:#f8f8f8;">sudo ufw allow ftp</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">Или</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f8f8;"><span style=" font-family:'monospace,monospace'; font-size:15px; color:#333333; background-color:#f8f8f8;">sudo ufw allow 21/tcp</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:x-large; color:#333333;"> </span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:x-large; color:#333333;">Добавление диапазонов портов</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f8f8;"><span style=" font-family:'monospace,monospace'; font-size:15px; color:#333333; background-color:#f8f8f8;">sudo ufw allow 3000:3100</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">Также вы можете указывать конкретный протокол:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">sudo ufw allow 3000:3100/tcp<br />sudo ufw allow 3000:3100/udp</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;"> </span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:x-large; color:#333333;">Добавление IP-адресов</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">Вs можете указать IP-адрес,  которому будет разрешен доступ.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f8f8;"><span style=" font-family:'monospace,monospace'; font-size:15px; color:#333333; background-color:#f8f8f8;">sudo ufw allow from 123.45.67.89</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">В приведённом примере указанному адресу разрешается доступ ко всем портам сервера.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">Если же вы хотите указать доступ к конкретному порту, воспользуйтесь командой вида:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f8f8;"><span style=" font-family:'monospace,monospace'; font-size:15px; color:#333333; background-color:#f8f8f8;">sudo ufw allow from 123.45.67.89 to any port 22</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">Аналогичным образом вы можете работать с диапазонами ip-адресов:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f8f8;"><span style=" font-family:'monospace,monospace'; font-size:15px; color:#333333; background-color:#f8f8f8;">sudo ufw allow from 123.45.67.89/24</span><span style=" font-family:'monospace,monospace'; font-size:15px; color:#333333;"><br /><br />sudo ufw allow from 123.45.67.89/24 to any port 22</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;"> </span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:x-large; color:#333333;">Ограничение подключений</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">Чтобы запретить HTTP-соединения, вы можете использовать следующую команду:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f8f8;"><span style=" font-family:'monospace,monospace'; font-size:15px; color:#333333; background-color:#f8f8f8;">sudo ufw deny http</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">Если вы хотите запретить все соединения с 123.45.67.89, воспользуйтесь следующей командой:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f8f8;"><span style=" font-family:'monospace,monospace'; font-size:15px; color:#333333; background-color:#f8f8f8;">sudo ufw deny from 123.45.67.89</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;"> </span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:x-large; color:#333333;">Удаление правил</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">Существует два способа удаления правил. Первый - по номеру правила.  Выполните команду:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f8f8;"><span style=" font-family:'monospace,monospace'; font-size:15px; color:#333333;"><br />sudo ufw status numbered</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f8f8;"><span style=" font-family:'monospace,monospace'; font-size:15px; color:#333333;">Status: active<br /><br /><br /><br /><br />     To                         Action      From<br /><br />     --                         ------      ----<br /><br />[ 1] 22                         ALLOW IN    Anywhere<br /><br />[ 2] 80                         ALLOW IN    Anywhere<br /><br />[ 3] 22 (v6)                    ALLOW IN    Anywhere (v6)<br /><br />[ 4] 80 (v6)                    ALLOW IN    Anywhere (v6)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;"><br />После этого выполните команду ufw delete и укажите номер правила, которое следует удалить:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f8f8;"><span style=" font-family:'monospace,monospace'; font-size:15px; color:#333333; background-color:#f8f8f8;">sudo ufw delete 2</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">Второй способ заключается в том, что после команды ufw delete используется фактическое правило, например</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f8f8;"><span style=" font-family:'monospace,monospace'; font-size:15px; color:#333333; background-color:#f8f8f8;">sudo ufw delete allow http</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">или </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f8f8;"><span style=" font-family:'monospace,monospace'; font-size:15px; color:#333333; background-color:#f8f8f8;">sudo ufw delete allow 80</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;"> </span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:x-large; color:#333333;">Отключение UFW</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">Отключить UFW можно при помощи команды:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f8f8;"><span style=" font-family:'monospace,monospace'; font-size:15px; color:#333333; background-color:#f8f8f8;">sudo ufw disable</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">В результате её выполнения всё созданные ранее правила утратят силу.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;"> </span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:x-large; color:#333333;">Сброс правил</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">Если вам требуется сбросить текущие настройки, воспользуйтесь командой:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f8f8;"><span style=" font-family:'monospace,monospace'; font-size:15px; color:#333333; background-color:#f8f8f8;">sudo ufw reset</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">В результате её выполнения все правила будут отключены и удалены.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;"> </span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:x-large; color:#333333;">Логи</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">В Ufw есть опция сохранения логов - журнал событий. Для запуска, используйте команду:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f8f8;"><span style=" font-family:'monospace,monospace'; font-size:15px; color:#333333;">sudo ufw logging on</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">Ufw поддерживает нескоько уровней логгирования:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;" style=" margin-top:20px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:15px; font-weight:600;">off</span><span style=" font-size:15px;"> - отключен.</span></li>
<li style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;" style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:15px; font-weight:600;">low </span><span style=" font-size:15px;">- регистрирует все заблокированные пакеты, не соответствующие заданной политике (с ограничением скорости), а также пакеты, соответствующие зарегистрированным правилам.</span></li>
<li style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;" style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:15px; font-weight:600;">medium  </span><span style=" font-size:15px;">- все то, что при значении </span><span style=" font-size:15px; font-weight:600;">low. </span><span style=" font-size:15px;">Плюс все разрешенные пакеты, не соответствующие заданной политике, все недопустимые пакеты, и все новые соединения. Все записи ведутся с ограничением скорости.</span></li>
<li style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;" style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:15px; font-weight:600;">high </span><span style=" font-size:15px;">-</span><span style=" font-size:15px; font-weight:600;">  </span><span style=" font-size:15px;">работает также как и </span><span style=" font-size:15px; font-weight:600;">medium. </span><span style=" font-size:15px;">Плюс все пакеты с ограничением скорости.</span></li>
<li style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;" style=" margin-top:0px; margin-bottom:20px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:15px; font-weight:600;">full</span><span style=" font-size:15px;"> - также как и </span><span style=" font-size:15px; font-weight:600;">high, </span><span style=" font-size:15px;">но без ограниения скорости. </span></li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">Что бы задать уровень, укажите его как параметр:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f8f8;"><span style=" font-family:'monospace,monospace'; font-size:15px; color:#333333; background-color:#f8f8f8;"> sudo ufw logging high</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">По-умолчанию используется уровень </span><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; font-weight:600; color:#333333;">low.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">Для просмотра файлов относящихся с логам ufw, используйте команду:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f8f8f8;"><span style=" font-family:'monospace,monospace'; font-size:15px; color:#333333; background-color:#f8f8f8;">ls /var/log/ufw*</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:x-large; color:#333333;">Заключение</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">Теперь ваш фаервол имеет минимально необходимые настройки для дальнейшей работы. Далее удостоверьтесь, что все подключения используемые вашим веб-приложением также разрешены и заблокируйте те, в которых нет необходимости. Это снизит риски проникновения на ваш сервер и совершения хакерами вредоносных действий. <br /> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://community.vscale.io/hc/ru/search?utf8=%E2%9C%93&amp;query=tglnkFirewall"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; text-decoration: underline; color:#ffffff; background-color:#1c98d3;">Firewall</span></a></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#666666;">2</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://www.facebook.com/share.php?title=%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0+%D1%84%D0%B0%D0%B5%D1%80%D0%B2%D0%BE%D0%BB%D0%B0+%D0%B2+Ubuntu+%D1%81+%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E+%D1%83%D1%82%D0%B8%D0%BB%D0%B8%D1%82%D1%8B+UFW&amp;u=https%3A%2F%2Fcommunity.vscale.io%2Fhc%2Fru%2Fcommunity%2Fposts%2F208348529-%25D0%259D%25D0%25B0%25D1%2581%25D1%2582%25D1%2580%25D0%25BE%25D0%25B9%25D0%25BA%25D0%25B0-%25D1%2584%25D0%25B0%25D0%25B5%25D1%2580%25D0%25B2%25D0%25BE%25D0%25BB%25D0%25B0-%25D0%25B2-Ubuntu-%25D1%2581-%25D0%25BF%25D0%25BE%25D0%25BC%25D0%25BE%25D1%2589%25D1%258C%25D1%258E-%25D1%2583%25D1%2582%25D0%25B8%25D0%25BB%25D0%25B8%25D1%2582%25D1%258B-UFW"><span style=" font-size:15px; text-decoration: underline; color:#1c98d3; background-color:transparent;">Facebook</span></a><span style=" font-size:15px;"> </span></li>
<li style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://twitter.com/share?lang=ru&amp;text=%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0+%D1%84%D0%B0%D0%B5%D1%80%D0%B2%D0%BE%D0%BB%D0%B0+%D0%B2+Ubuntu+%D1%81+%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E+%D1%83%D1%82%D0%B8%D0%BB%D0%B8%D1%82%D1%8B+UFW&amp;url=https%3A%2F%2Fcommunity.vscale.io%2Fhc%2Fru%2Fcommunity%2Fposts%2F208348529-%25D0%259D%25D0%25B0%25D1%2581%25D1%2582%25D1%2580%25D0%25BE%25D0%25B9%25D0%25BA%25D0%25B0-%25D1%2584%25D0%25B0%25D0%25B5%25D1%2580%25D0%25B2%25D0%25BE%25D0%25BB%25D0%25B0-%25D0%25B2-Ubuntu-%25D1%2581-%25D0%25BF%25D0%25BE%25D0%25BC%25D0%25BE%25D1%2589%25D1%258C%25D1%258E-%25D1%2583%25D1%2582%25D0%25B8%25D0%25BB%25D0%25B8%25D1%2582%25D1%258B-UFW"><span style=" font-size:15px; text-decoration: underline; color:#1c98d3; background-color:transparent;">Twitter</span></a><span style=" font-size:15px;"> </span></li>
<li style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://www.linkedin.com/shareArticle?mini=true&amp;source=+Vscale+Community&amp;title=%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0+%D1%84%D0%B0%D0%B5%D1%80%D0%B2%D0%BE%D0%BB%D0%B0+%D0%B2+Ubuntu+%D1%81+%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E+%D1%83%D1%82%D0%B8%D0%BB%D0%B8%D1%82%D1%8B+UFW&amp;url=https%3A%2F%2Fcommunity.vscale.io%2Fhc%2Fru%2Fcommunity%2Fposts%2F208348529-%25D0%259D%25D0%25B0%25D1%2581%25D1%2582%25D1%2580%25D0%25BE%25D0%25B9%25D0%25BA%25D0%25B0-%25D1%2584%25D0%25B0%25D0%25B5%25D1%2580%25D0%25B2%25D0%25BE%25D0%25BB%25D0%25B0-%25D0%25B2-Ubuntu-%25D1%2581-%25D0%25BF%25D0%25BE%25D0%25BC%25D0%25BE%25D1%2589%25D1%258C%25D1%258E-%25D1%2583%25D1%2582%25D0%25B8%25D0%25BB%25D0%25B8%25D1%2582%25D1%258B-UFW"><span style=" font-size:15px; text-decoration: underline; color:#1c98d3; background-color:transparent;">LinkedIn</span></a><span style=" font-size:15px;"> </span></li>
<li style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://plus.google.com/share?hl=ru&amp;url=https%3A%2F%2Fcommunity.vscale.io%2Fhc%2Fru%2Fcommunity%2Fposts%2F208348529-%25D0%259D%25D0%25B0%25D1%2581%25D1%2582%25D1%2580%25D0%25BE%25D0%25B9%25D0%25BA%25D0%25B0-%25D1%2584%25D0%25B0%25D0%25B5%25D1%2580%25D0%25B2%25D0%25BE%25D0%25BB%25D0%25B0-%25D0%25B2-Ubuntu-%25D1%2581-%25D0%25BF%25D0%25BE%25D0%25BC%25D0%25BE%25D1%2589%25D1%258C%25D1%258E-%25D1%2583%25D1%2582%25D0%25B8%25D0%25BB%25D0%25B8%25D1%2582%25D1%258B-UFW"><span style=" font-size:15px; text-decoration: underline; color:#1c98d3; background-color:transparent;">Google+</span></a><a href="https://community.vscale.io/hc/ru/community/posts/208348529-%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0-%D1%84%D0%B0%D0%B5%D1%80%D0%B2%D0%BE%D0%BB%D0%B0-%D0%B2-Ubuntu-%D1%81-%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E-%D1%83%D1%82%D0%B8%D0%BB%D0%B8%D1%82%D1%8B-UFW#comment-overview"><span style=" font-size:15px; font-weight:296; text-decoration: underline; color:#666666; background-color:transparent;"> 3</span></a></li></ul>
<p align="center" style=" margin-top:0px; margin-bottom:5px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:large; color:#333333;">Комментарии</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:13px; font-weight:296; color:#666666;">Комментариев: 3</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:13px; font-weight:296; color:#666666; background-color:transparent; vertical-align:middle;">Сортировка</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><img src="image2051938228.png" /></li>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><a href="https://community.vscale.io/hc/ru/profiles/5825071589-TimO-n"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; text-decoration: underline; color:#1c98d3; background-color:transparent;">TimO_n</span></a><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:13px; font-weight:296; color:#666666;">16 октябрь 2016 г. 07:23</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; line-height:1.6%;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">Советую в первых минутах работы с фаерволом включить логирование:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; background-color:#f8f8f8;"><span style=" font-family:'monospace,monospace'; font-size:15px; color:#333333; background-color:#f8f8f8;">ufw logging on</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">Если в логах (/var/log/ufw.log) ваших конектов не видно, не забдьте выключить логирование. Иначе, в случае дудоса, ufw изнасилует ваши диски =)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">Так же, на мой взгляд, правильным будет выставить лимит подключений на порт ssh:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; background-color:#f8f8f8;"><span style=" font-family:'monospace,monospace'; font-size:15px; color:#333333; background-color:#f8f8f8;">ufw limit 22/tcp</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#666666;">3</span></p>
<li style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><img src="image1845767635.png" /></li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><a href="https://community.vscale.io/hc/ru/profiles/5367462729-%D0%90%D0%BB%D0%B5%D0%BA%D1%81%D0%B0%D0%BD%D0%B4%D1%80-%D0%94%D0%B6%D1%83%D1%80%D0%B8%D0%BD%D1%81%D0%BA%D0%B8%D0%B9"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; text-decoration: underline; color:#1c98d3; background-color:transparent;">Александр Джуринский</span></a><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:13px; font-weight:296; color:#666666;">25 октябрь 2016 г. 18:32 (Изменен 2 года назад)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; line-height:1.6%;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">Упустили важный момент - необходимо учитывать, что по умолчанию правила добавляются в конец списка IPTABLES и применяются они к пакету сверху вниз по списку. Отсюда надо понимать, что если у вас есть список правил к примеру:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; background-color:#f8f8f8;"><span style=" font-family:'monospace,monospace'; font-size:15px; color:#333333;">     To                         Action      From<br />     --                         ------      ----<br />[ 1] 22                         ALLOW IN    Anywhere                  <br />[ 2] 80                         ALLOW IN    Anywhere</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">и вы блокируете IP командой:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; background-color:#f8f8f8;"><span style=" font-family:'monospace,monospace'; font-size:15px; color:#333333; background-color:#f8f8f8;">sudo ufw deny from 123.45.67.89</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; background-color:#f8f8f8;"><span style=" font-family:'monospace,monospace'; font-size:15px; color:#333333;">     To                         Action      From<br />     --                         ------      ----<br />[ 1] 22                         ALLOW IN    Anywhere                  <br />[ 2] 80                         ALLOW IN    Anywhere                  <br />[ 3] Anywhere                   DENY IN     123.45.67.89</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">то правило будет добавлено в конец списка и заблокированный IP будет продолжать иметь доступ к 22/80 портам.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;">Правильнее будет добавлять в начало списка командой:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; background-color:#f8f8f8;"><span style=" font-family:'monospace,monospace'; font-size:15px; color:#333333;"> sudo ufw insert 1 deny from 123.45.67.89</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; background-color:#f8f8f8;"><span style=" font-family:'monospace,monospace'; font-size:15px; color:#333333;">     To                         Action      From<br />     --                         ------      ----<br />[ 1] Anywhere                   DENY IN     123.45.67.89              <br />[ 2] 22                         ALLOW IN    Anywhere                  <br />[ 3] 80                         ALLOW IN    Anywhere</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Open Sans,Arial,sans-serif'; font-size:15px; color:#333333;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu';"> </span></p></body></html>