<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" align="center" width="90%" cellspacing="2" cellpadding="0">
<tr>
<td>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" align="center" width="100%" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://housecomputer.ru/"><span style=" font-family:'Ubuntu'; text-decoration: underline; color:#0000ff;">Главная</span></a><span style=" font-family:'Ubuntu';"> | </span><a href="https://housecomputer.ru/feedback.html"><span style=" font-family:'Ubuntu'; text-decoration: underline; color:#0000ff;">Контакты</span></a><span style=" font-family:'Ubuntu';"> | </span><a href="https://housecomputer.ru/settings.html"><span style=" font-family:'Ubuntu'; text-decoration: underline; color:#0000ff;">Настройки</span></a><span style=" font-family:'Ubuntu';"> </span></p></td>
<td style=" vertical-align:middle;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu';">СМЕНИТЬ ПАЛИТРУ: </span><img src="image604483926.png" style="vertical-align: middle;" /><span style=" font-family:'Ubuntu';"> </span><img src="image1157657020.png" style="vertical-align: middle;" /><span style=" font-family:'Ubuntu';"> </span><img src="image244532928.png" style="vertical-align: middle;" /><span style=" font-family:'Ubuntu';"> </span></p></td>
<td width="300">
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" align="right" cellspacing="0" cellpadding="0">
<tr>
<td>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td></td>
<td></td></tr></table></td></tr></table></td></tr></table></td></tr></table></td></tr></table>
<p align="center" style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Ubuntu';"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" align="center" width="90%" cellspacing="2" cellpadding="0">
<tr>
<td>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" align="center" width="100%" cellspacing="2" cellpadding="0">
<tr>
<td width="300">
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" align="right" cellspacing="0" cellpadding="0">
<tr>
<td>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td></td></tr></table></td>
<td></td></tr></table></td></tr></table>
<hr />
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://housecomputer.ru/"><span style=" font-family:'Ubuntu'; text-decoration: underline; color:#0000ff;">Главная</span></a><span style=" font-family:'Ubuntu';"> &gt; </span><a href="https://housecomputer.ru/os/os.html"><span style=" font-family:'Ubuntu'; text-decoration: underline; color:#0000ff;">Операционные системы</span></a><span style=" font-family:'Ubuntu';"> &gt; </span><a href="https://housecomputer.ru/os/unix/unix.html"><span style=" font-family:'Ubuntu'; text-decoration: underline; color:#0000ff;">UNIX</span></a><span style=" font-family:'Ubuntu';"> &gt; </span><a href="https://housecomputer.ru/os/unix/linux/linux.html"><span style=" font-family:'Ubuntu'; text-decoration: underline; color:#0000ff;">Linux</span></a><span style=" font-family:'Ubuntu';"> </span></p>
<p align="center" style=" margin-top:18px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-size:xx-large; font-weight:600;">Обзор программ для мониторинга работы железа в Linux</span><span style=" font-family:'Ubuntu';"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-size:large; font-weight:600;">Как здоровье, пингвин?</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-size:large; font-weight:600;">Юрий Раззоренов</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-weight:600;">Хакер, номер #103, стр. 103-102-1</span></p>
<hr width="200"/>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-size:x-large; font-weight:600;">Обзор программ для мониторинга работы железа в Linux</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu';">Лето. На улице уже который день стоит жара. Три вентилятора в системном блоке с большим трудом справляются с охлаждением, хотя шумят прилично. Иногда создается впечатление, что системный блок можно использовать вместо печки. Как узнать, что происходит внутри, не дотрагиваясь пальцами до деталей включенного компьютера? Может, уже пора дать отдохнуть своему железному другу? Или поставить еще один кулер? В составе любого дистрибутива Linux найдется несколько утилит, которые помогут получить ответ на эти и другие вопросы и расскажут все о текущем состоянии железа.</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-size:x-large; font-weight:600;">lm-sensors: стандарт де-факто</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu';">В Debian, Ubuntu и других дистрибутивах, использующих apt, команда apt-cache search monitoring выдает большой список пакетов на все случаи жизни. Все их рассмотреть не получится, да и, наверное, не нужно. Мониторинг оборудования (температура, вращение вентиляторов, напряжение питания) будем производить с помощью утилиты</span><span style=" font-family:'Ubuntu'; font-weight:600;"> lm-sensors</span><span style=" font-family:'Ubuntu';"> (</span><a href="http://www.lm-sensors.org"><span style=" font-family:'Ubuntu'; text-decoration: underline; color:#0000ff;">www.lm-sensors.org</span></a><span style=" font-family:'Ubuntu';">). Утилита собирает и анализирует все, что идет по шине </span><span style=" font-family:'Ubuntu'; font-weight:600;">SMB</span><span style=" font-family:'Ubuntu';"> (System Management Bus), к которой могут быть подключены не только процессор и материнская плата, но и модули памяти, видеокарта и прочее оборудование. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu';">В ядрах 2.4 установка </span><span style=" font-family:'Ubuntu'; font-weight:600;">lm-sensors</span><span style=" font-family:'Ubuntu';"> могла вызвать легкий стресс, но с интеграцией в ядро 2.6 компонентов, осуществляющих мониторинг, заставить ее работать уже не проблема. Информацию о поддержке своего оборудования </span><span style=" font-family:'Ubuntu'; font-weight:600;">lm-sensors</span><span style=" font-family:'Ubuntu';"> и ядром можно найти на странице</span><span style=" font-family:'Ubuntu'; font-weight:600;"> Devices and drivers</span><span style=" font-family:'Ubuntu';"> (</span><a href="http://www.lm-sensors.org/wiki/Devices"><span style=" font-family:'Ubuntu'; text-decoration: underline; color:#0000ff;">www.lm-sensors.org/wiki/Devices</span></a><span style=" font-family:'Ubuntu';">). Здесь же уточняем, какую версию </span><span style=" font-family:'Ubuntu'; font-weight:600;">lm-sensors</span><span style=" font-family:'Ubuntu';"> рекомендуется использовать с установленным в системе ядром. Хотя можно особо и не выбирать, а ставить то, что предлагается в репозитарии. Так как утилиты диагностики частью ядра не являются, их следует устанавливать отдельно: </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">$ sudo apt-get install lm-sensors sensord</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu';">Заодно установим и демон sensord, его задача собирать информацию в syslog. Кроме того, в случае неприятностей он может выдать предупреждение. Для первоначальной настройки системы мониторинга следует использовать утилиту </span><span style=" font-family:'Ubuntu'; font-weight:600;">sensors-detect</span><span style=" font-family:'Ubuntu';">:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">$ sudo sensors-detect</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu';">После запуска утилиты тебе будет устроен настоящий допрос с пристрастием. Следует отвечать честно, ничего не скрывая :). В случае сомнения можно разрешать все тесты. Утилита пройдется по всем шинам и устройствам, переберет все скомпилированные модули и выберет те, от которых есть хоть какой-то прок. Если будет выведена хотя бы пара , считай, что тебе повезло. А значит, мониторингу быть. По окончании утилита запросит создать настройки в соответствии с найденным оборудованием: </span><span style=" font-family:'Ubuntu'; font-style:italic;">- и выдаст строку, которую необходимо вставить в файл /etc/modules. Выбрав на следующем шаге Yes, можно разрешить ей сделать это самостоятельно. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-style:italic;">Советую проверить в /lib/modules/2.6.x/modules наличие всех модулей, которые порекомендовал загрузить sensors-detect. Скрипт иногда бежит впереди паровоза или, наоборот, отстает, поэтому вполне может быть, что таких модулей в системе попросту нет. Так, однажды мне было предложено использовать i2c-nforce2, но такой модуль в системе отсутствовал. Как вариант - можно попробовать загрузить модули вручную с помощью .</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-style:italic;">Для получения информации с сенсоров вызываем утилиту sensors без параметров (можно уже под обычным пользователем):</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">$ sensors</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">lm85b-i2c-0-2e</span><span style=" font-family:'Ubuntu'; font-style:italic;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">Adapter: SMBus I801 adapter at c800</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">VoltA1_5: +1.49 V (min = +1.42 V, max = +1.58 V)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">Volt1_5: +1.52 V (min = +1.45 V, max = +1.60 V)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">Volt3_3: +3.23 V (min = +3.13 V, max = +3.47 V)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">Volt5: +5.20 V (min = +4.74 V, max = +5.26 V)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">Volt12: +12.01 V (min = +11.38 V, max = +12.62 V)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">FanCPU: 3540 RPM (min = 4000 RPM)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">TempCPU: +28C (low = +10C, high = +55C)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">TempMB1: +31C (low = +10C, high = +55C)</span><span style=" font-family:'Ubuntu'; font-style:italic;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">TempMB2: +34C (low = +10C, high = +55C)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">CPUF_PWM: 255</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">SysF1_PWM: 255</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">SysF2_PWM: 77</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">vid: +1.525 V (VRM Version 9.1)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-style:italic;">Параметры вывода на экран настраиваются в файле /etc/sensors.conf. Ищем строку, соответствующую нашему чипу (в нашем примере это lm85), и правим при необходимости:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">$ sudo mcedit /etc/sensors.conf</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">chip &quot;lm85c-*&quot; &quot;adm1027-*&quot; &quot;adt7463-*&quot; &quot;lm85-*&quot; &quot;lm85b-*&quot;</span><span style=" font-family:'Ubuntu'; font-style:italic;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;"># Метки вольтажа</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">label in0 &quot;V1.5&quot;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">label in1 &quot;VCore&quot;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">...</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;"># Температура</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">label temp1 &quot;CPU Temp&quot;</span><span style=" font-family:'Ubuntu'; font-style:italic;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">label temp2 &quot;Board Temp&quot;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">...</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;"># Кулер</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">label fan1 &quot;CPU_Fan&quot;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;"># Установка лимита вольтажа</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">set in0_min 1.5 * 0.95</span><span style=" font-family:'Ubuntu'; font-style:italic;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;"># Лимит кулера</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">set fan1_min 4000</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-style:italic;">Хотелось бы обратить внимание на утилиту </span><span style=" font-family:'Ubuntu'; font-weight:600; font-style:italic;">KSensors</span><span style=" font-family:'Ubuntu'; font-style:italic;"> (</span><a href="http://ksensors.sourceforge.net"><span style=" font-family:'Ubuntu'; font-style:italic; text-decoration: underline; color:#0000ff;">ksensors.sourceforge.net</span></a><span style=" font-family:'Ubuntu'; font-style:italic;">), которая является графическим интерфейсом к sensors для среды KDE. В Ubuntu она устанавливается обычным образом:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">$ sudo apt-get install ksensors</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-style:italic;">Теперь запускаем ее через меню или из командной строки. Щелкаем по появившемуся значку и выбираем Configure. Затем переходим по вкладкам и включаем флажок Visible в тех параметрах, которые хотим видеть. Результат будет выведен на панели задач (если активирован Dock) и в отдельном окне, которое открывается двойным щелчком по значку </span><span style=" font-family:'Ubuntu'; font-weight:600; font-style:italic;">KSensors</span><span style=" font-family:'Ubuntu'; font-style:italic;">. Кроме параметров, контролируемых с помощью утилиты lm-sensors, можно выводить состояние памяти, swap и некоторую другую информацию. Для каждого параметра можно выставить интервал обновления и реакцию системы при превышении заданного значения (выполнить команду или проиграть звук). Чтобы </span><span style=" font-family:'Ubuntu'; font-weight:600; font-style:italic;">KSensor</span><span style=" font-family:'Ubuntu'; font-style:italic;"> автоматически запускался при загрузке системы, не забудь установить Autostart KSensors on KDE startup во вкладке Global settings. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-style:italic;">Настройки демона sensord производятся в файле /etc/default/sensord.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">$ sudo mcedit /etc/default/sensord</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;"># Интервал для сканирования на предупреждения (30s, 1m, 1h)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">ALARM_INTERVAL=1m</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;"># Интервал между замерами для записи в журнал</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">LOG_INTERVAL=30m</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">SYSLOG_FACILITY=daemon</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">CONFIG_FILE=/etc/sensors.conf</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;"># Чип берем из sensors.conf</span><span style=" font-family:'Ubuntu'; font-style:italic;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">SCAN_CHIPS= lm85b-*</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;"># Снимаем комментарий, если нужен вывод для RRD (Round Robin Database)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;"># RRD_FILE=/var/log/sensord.rrd</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;"># Интервал, по умолчанию 5 минут</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;"># RRD_INTERVAL=5m</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;"># RRD_LOADAVG=yes</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-style:italic;">В комплекте </span><span style=" font-family:'Ubuntu'; font-weight:600; font-style:italic;">lm-sensors </span><span style=" font-family:'Ubuntu'; font-style:italic;">идет утилита pwmconfig, которая проверяет возможность изменения скорости вращения кулеров. Если такая функциональность имеется, для настройки скорости вращения следует использовать утилиту fancontrol. Конфигурационный файл для нее создается с помощью pwmconfig.</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-size:x-large; font-weight:600; font-style:italic;">Утилита (x)mbmon</span><span style=" font-family:'Ubuntu'; font-style:italic;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-style:italic;">Естественно, кроме lm-sensors есть и другие решения. Например, утилита </span><span style=" font-family:'Ubuntu'; font-weight:600; font-style:italic;">mbmon</span><span style=" font-family:'Ubuntu'; font-style:italic;"> (MotherBoard Monitor) и графический интерфейс к ней: xmbmon. С их помощью можно контролировать температуру компонентов системы, скорость вращения кулера и вольтаж. Исходные тексты можно найти на сайте автора: </span><a href="http://www.nt.phys.kyushu-u.ac.jp/shimizu/download/download.html"><span style=" font-family:'Ubuntu'; font-style:italic; text-decoration: underline; color:#0000ff;">www.nt.phys.kyushu-u.ac.jp/shimizu/download/download.html</span></a><span style=" font-family:'Ubuntu'; font-style:italic;">. Установка в Ubuntu не сложна:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">$ sudo apt-get install mbmon xmbmon</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-style:italic;">Теперь можно запускать без каких-либо настроек:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">$ sudo mbmon</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">Temp.= 30.0, 24.0, 127.0; Rot.= 3308, 0, 6026</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">Vcore = 1.14, 1.52; Volt. = 3.28, 5.00, 11.49, -6.62, -1.83</span><span style=" font-family:'Ubuntu'; font-style:italic;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-style:italic;">Запустив xmbmon, всю эту информацию можно увидеть в окне программы.</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-size:x-large; font-weight:600; font-style:italic;">Мониторинг жесткого диска с hddtemp</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-style:italic;">Вообще говоря, процессор не самая главная часть компьютера. Вот если полетит жесткий диск, считай, пропали фильмы, курсовые, дипломы и т.д. Поэтому винт требует особого внимания. В Linux есть ряд утилит как раз для этого случая. Начнем с маленькой по размеру, но очень полезной утилиты hddtemp (</span><a href="http://www.guzu.net/linux/hddtemp.php"><span style=" font-family:'Ubuntu'; font-style:italic; text-decoration: underline; color:#0000ff;">www.guzu.net/linux/hddtemp.php</span></a><span style=" font-family:'Ubuntu'; font-style:italic;">). С ее помощью можно получать информацию о температуре с IDE/SATA/SCSI-дисков, а также считывать S.M.A.R.T. информацию. Устанавливаем:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">$ sudo apt-get install hddtemp</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-style:italic;">Кроме этого, рекомендуется обновить и базу дисков, скачав файл </span><a href="http://www.guzu.net/linux/hddtemp.db"><span style=" font-family:'Ubuntu'; font-style:italic; text-decoration: underline; color:#0000ff;">www.guzu.net/linux/hddtemp.db</span></a><span style=" font-family:'Ubuntu'; font-style:italic;"> и поместив его в /etc. Вызов очень прост:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">$ sudo hddtemp /dev/sda</span><span style=" font-family:'Ubuntu'; font-style:italic;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">/dev/sda: ST3160811AS: нет датчика</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-style:italic;">Да, с барракудой не повезло, посмотрим, что скажет утилита о втором диске:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">$ sudo hddtemp /dev/hdb</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">/dev/hdb: QUANTUM FIREBALLlct20: 31C or F</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-style:italic;">Результат: температура файрбола. Как вариант - hddtemp можно запустить в фоне. Получить информацию в этом случае возможно в журнале syslog или подключившись по сети:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">$ sudo hddtemp -d -q /dev/hdb</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-style:italic;">Телнетимся:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">$ telnet localhost 7634</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">Trying 127.0.0.1...</span><span style=" font-family:'Ubuntu'; font-style:italic;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">Connected to localhost.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">Escape character is '^]'.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">|/dev/hdb|QUANTUM FIREBALLlct20 30|32|C|Connection closed by foreign host.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-style:italic;">Результат: 32 градуса. Таким образом температура диска выясняется даже без регистрирации в системе.</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-size:x-large; font-weight:600; font-style:italic;">Комплект smartmontools</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-style:italic;">С помощью набора утилит </span><span style=" font-family:'Ubuntu'; font-weight:600; font-style:italic;">smartmontools</span><span style=" font-family:'Ubuntu'; font-style:italic;"> (</span><a href="http://smartmontools.sf.net"><span style=" font-family:'Ubuntu'; font-style:italic; text-decoration: underline; color:#0000ff;">smartmontools.sf.net</span></a><span style=" font-family:'Ubuntu'; font-style:italic;">) можно контролировать и управлять некоторыми параметрами жесткого диска, используя технологию S.M.A.R.T. Поддерживаются диски с интерфейсами ATA, SCSI и SATA. Для начала стоит проверить статус подключенных устройств: </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">$ sudo smartd -q onecheck</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">Opened configuration file /etc/smartd.conf</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">Drive: DEVICESCAN, implied '-a' Directive on line 22 of file /etc/smartd.conf</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">Configuration file /etc/smartd.conf was parsed, found DEVICESCAN, scanning devices</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">Device: /dev/hda, opened</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">Device: /dev/hda, packet devices [this device CD/DVD] not SMART capable</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">Unable to register ATA device /dev/hda at line 22 of file /etc/smartd.conf</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">Device: /dev/hdb, opened</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">Device: /dev/hdb, found in smartd database.</span><span style=" font-family:'Ubuntu'; font-style:italic;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">Device: /dev/hdb, is SMART capable. Adding to &quot;monitor&quot; list.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">Device: /dev/sda, opened</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">Device: /dev/sda, IE (SMART) not enabled, skip device</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">Try 'smartctl -s on /dev/sda' to turn on SMART features</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">Unable to register SCSI device /dev/sda at line 22 of file /etc/smartd.conf</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">Monitoring 1 ATA and 0 SCSI devices</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-style:italic;">Последняя строка показывает, что будет производиться мониторинг только ATA-диска. На устройстве /dev/sda SMART не активирован, при необходимости его можно включить с помощью вызова . Пробуем получить информацию о диске: </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">$ sudo smartctl -i /dev/hdb</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">Model Family: QUANTUM FIREBALLlct20 series</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">Device Model: QUANTUM FIREBALLlct20 30</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">Serial Number: 353106162000</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">Firmware Version: APL.3900</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">User Capacity: 30.020.272.128 bytes</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">Device is: In smartctl database [for details use: -P show]</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">ATA Version is: 5</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">ATA Standard is: ATA/ATAPI-5 T13 1321D revision 1</span><span style=" font-family:'Ubuntu'; font-style:italic;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">Local Time is: Sun May 20 17:32:12 2007 EEST</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">SMART support is: Available - device has SMART capability.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">SMART support is: Enabled</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-style:italic;">Более полную информацию можно получить, запустив утилиту с флагом '-a'. Вывод займет пару экранов, в самом конце будет выведена таблица со списком контролируемых параметров. Особое внимание следует обратить на поле WHEN_FAILED, в котором отобразится приблизительная дата, когда этот параметр достигнет своего допустимого предела. Эти тесты можно вызвать и отдельно. Причем есть два варианта: сокращенный и полный. Они инициируются командами:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">$ sudo smartctl -t short /dev/hdb</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-style:italic;">Или:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">$ sudo smartctl -t long /dev/hdb</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-style:italic;">Сокращенная проверка длится 1-2 минуты, полная может занять около часа. На работу диска эти тесты никак не влияют, поэтому их можно спокойно запускать на работающей системе. Ошибка будет выведена в поле LBA_of_first_error. Колонка LifeTime покажет время, прошедшее с момента включения диска до проведения проверки. Оффлайновые тесты запускаются командой </span><span style=" font-family:'Courier New,courier'; font-style:italic;">smartctl -t offline</span><span style=" font-family:'Ubuntu'; font-style:italic;">; их назначение - обновление показателей состояния диска, которые не могут быть обновлены во время обычной работы. Используя </span><span style=" font-family:'Courier New,courier'; font-style:italic;">smartctl -o on</span><span style=" font-family:'Ubuntu'; font-style:italic;">, можно разрешить дискам производить такую проверку самостоятельно. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-style:italic;">Мониторинг следует производить постоянно. Для этих целей используется демон smartd, который также входит в состав smartmontools. По умолчанию он проверяет все диски каждые 30 минут, информацию выводит с помощью syslog. Демона можно научить при обнаружении проблем отсылать почтовое сообщение администратору или выполнять скрипт. Шаблон содержит большое количество примеров. Каждая строка файла описывает параметры одного из присутствующих в системе дисков. Например:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">$ sudo mcedit /etc/smartd.conf</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">/dev/sda -S on -o on -a -I 194 -m admin@host.com</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">/dev/hdb -S on -o on -a -I 194 -m admin@host.com</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-style:italic;">Здесь мы указываем диск, директивой -S on включаем автоматическое сохранение значений показателей. -o on отвечает за проведение регулярного оффлайнового тестирования. С помощью -I 194 игнорируем значение показателя с ID #194, отвечающего за контроль температуры, и в конце указываем email для отправки уведомлений. Проверить отсылку сообщений можно командой smartd -M test. Теперь запускаем демон:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">$ sudo /etc/init.d/smartd start</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-style:italic;">Вот, в общем-то, и все, о чем мне хотелось сегодня рассказать. Кстати, пользователи FreeBSD тоже не обделены возможностями наблюдения за здоровьем своей системы. Все необходимое можно найти в дереве /usr/ports/sysutils коллекции портов. Из графических утилит, не попавших в обзор, стоит отметить </span><span style=" font-family:'Ubuntu'; font-weight:600; font-style:italic;">gkrellm</span><span style=" font-family:'Ubuntu'; font-style:italic;"> (</span><a href="http://www.gkrellm.net"><span style=" font-family:'Ubuntu'; font-style:italic; text-decoration: underline; color:#0000ff;">www.gkrellm.net</span></a><span style=" font-family:'Ubuntu'; font-style:italic;">) и </span><span style=" font-family:'Ubuntu'; font-weight:600; font-style:italic;">conky</span><span style=" font-family:'Ubuntu'; font-style:italic;"> (</span><a href="http://conky.sf.net"><span style=" font-family:'Ubuntu'; font-style:italic; text-decoration: underline; color:#0000ff;">conky.sf.net</span></a><span style=" font-family:'Ubuntu'; font-style:italic;">), с которыми, я надеюсь, ты разберешься уже сам. </span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-size:x-large; font-weight:600; font-style:italic;">Файловая система /proc</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-style:italic;">Некоторую информацию можно получить, обратившись напрямую к файловой системе /proc. Для примера проверим, включен ли кулер на процессоре:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">$ sudo cat /proc/acpi/fan/FAN/state</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">status: on</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-style:italic;">Возможность его выключения командой </span><span style=" font-family:'Courier New,courier'; font-style:italic;">echo 0 &gt; /proc/acpi/fan/FAN/state</span><span style=" font-family:'Ubuntu'; font-style:italic;"> зависит от материнской платы. Температуру процессора можно просмотреть так:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">$ sudo cat /proc/acpi/thermal_zone/THRM/temperature</span><span style=" font-family:'Ubuntu'; font-style:italic;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">temperature: 23 C</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-style:italic;">В Linux температура выводится в градусах Цельсия, в других системах - в кельвинах. Кстати, есть целая утилита от разработчиков KDE, называется KTemperature, найти ее можно по адресу </span><a href="http://www.kde-apps.org/content/show.php?content=24660"><span style=" font-family:'Ubuntu'; font-style:italic; text-decoration: underline; color:#0000ff;">www.kde-apps.org/content/show.php?content=24660</span></a><span style=" font-family:'Ubuntu'; font-style:italic;"> или в репозитарии. Она как раз считывает информацию из этого файла и выводит результат на панель задач в виде индикатора.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-style:italic;">В trip_points можно считать или задать политику управления охлаждением системы:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">$ sudo cat /proc/acpi/thermal_zone/THRM/trip_points</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">critical (S5): 65 C</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">passive: 63 C: tc1=4 tc2=3 tsp=60 devices=0xdf852338</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">active[0]: 63 C: devices=0xdf85ff90</span><span style=" font-family:'Ubuntu'; font-style:italic;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-style:italic;">Возможны три варианта политики: critical (критическая температура, после которой возможен автоматический переход в спящий режим), passive (уменьшение частоты процессора) и active (активный режим работы кулера). Причем active может иметь несколько ступеней: от 0 до 9. Команда на изменение этих параметров выглядит так: </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">$ echo -n &quot;critical:hot:passive:active0:...:activeX&quot; &gt; trip_points</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-style:italic;">Например:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">$ echo &quot;105:100:100:78:70:60:50&quot; &gt; /proc/acpi/thermal_zone/TZ0/trip_points</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-style:italic;">Режим охлаждения можно просмотреть такой командой: </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">$ sudo cat /proc/acpi/thermal_zone/THRM/cooling_mode</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">cooling mode: active</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-style:italic;">Устанавливать пассивный режим возможно не на всех устройствах, хотя современные ноутбуки его обычно поддерживают. Частота опроса сенсоров указывается в polling_frequency:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">$ sudo cat /proc/acpi/thermal_zone/THRM/polling_frequency</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">&lt;polling disabled&gt;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-style:italic;">Это означает, что в случае изменений само устройство способно генерировать асинхронные прерывания, поэтому наблюдать за ним нет смысла. Более подробную информацию о thermal_zone можно найти на сайте </span><a href="http://acpi.sourceforge.net/documentation/thermal.html"><span style=" font-family:'Ubuntu'; font-style:italic; text-decoration: underline; color:#0000ff;">acpi.sourceforge.net/documentation/thermal.html</span></a><span style=" font-family:'Ubuntu'; font-style:italic;">.</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-size:x-large; font-weight:600; font-style:italic;">Подготовка дистрибутива</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-style:italic;">Для того чтобы большинство описанных утилит заработало, необходимо иметь поддержку I2C и Hardware Monitoring в ядре. То есть как минимум всего, что выдают команды &lt;</span><span style=" font-family:'Courier New,courier'; font-style:italic;">cat /usr/src/linux/.config | grep LM</span><span style=" font-family:'Ubuntu'; font-style:italic;">&gt; и &lt;</span><span style=" font-family:'Courier New,courier'; font-style:italic;">cat /usr/src/linux/.config | grep I2C2</span><span style=" font-family:'Ubuntu'; font-style:italic;">&gt;. Поэтому если вывод молчит как рыба об лед, можешь смело приступать к пересборке ядра. В Hardware Monitoring не забываем включить поддержку своей материнской платы. Если сомневаешься, то просто собери все в виде модулей. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">$ sudo make mеnuconfig</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-style:italic;">Включаем поддержку ACPI:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">Power management options (ACPI, APM) - ACPI (Advanced Configuration and Power Interface) Support</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-style:italic;">Не забываем стандарт управления сенсорами IPMI:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">Device Drivers - Character devices - IPMI</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-style:italic;">Обязательно включаем поддержку сенсоров в ядре:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">Device Drivers - I2C support</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-style:italic;">Выбираем алгоритмы, используемые в чипах:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">Device Drivers - I2C support ---&gt; I2C Algorithms</span><span style=" font-family:'Ubuntu'; font-style:italic;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-style:italic;">В следующих пунктах выбираем установленный чипсет:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">Device Drivers - I2C support - I2C Hardware Bus support</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">Device Drivers - I2C support - Miscellaneous I2C Chip support</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-style:italic;">И, наконец, выбираем драйверы к сенсорам:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">Device Drivers - Hardware Monitoring support</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-style:italic;">Начиная с версии ядра 2.6.19, появился новый драйвер мониторинга </span><span style=" font-family:'Ubuntu'; font-weight:600; font-style:italic;">k8temp</span><span style=" font-family:'Ubuntu'; font-style:italic;">, который поддерживает все последние модели AMD K8. В соответствующих системах этот драйвер загружается автоматически. Отмечена его несовместимость со старыми версиями lm-sensors. Поэтому обязательно обнови утилиту или занеси k8temp в черный список, иначе General parse error тебе обеспечена.</span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Ubuntu'; font-style:italic;">Материал взят с сайта: </span><a href="http://www.xakep.ru/magazine/xa/103/102/1.asp"><span style=" font-family:'Ubuntu'; font-style:italic; text-decoration: underline; color:#0000ff;">http://www.xakep.ru/magazine/xa/103/102/1.asp</span></a><span style=" font-family:'Ubuntu'; font-style:italic;"><br /></span></p>
<hr />
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://housecomputer.ru/"><span style=" font-family:'Ubuntu'; font-style:italic; text-decoration: underline; color:#0000ff;">Главная</span></a><span style=" font-family:'Ubuntu'; font-style:italic;"> &gt; </span><a href="https://housecomputer.ru/os/os.html"><span style=" font-family:'Ubuntu'; font-style:italic; text-decoration: underline; color:#0000ff;">Операционные системы</span></a><span style=" font-family:'Ubuntu'; font-style:italic;"> &gt; </span><a href="https://housecomputer.ru/os/unix/unix.html"><span style=" font-family:'Ubuntu'; font-style:italic; text-decoration: underline; color:#0000ff;">UNIX</span></a><span style=" font-family:'Ubuntu'; font-style:italic;"> &gt; </span><a href="https://housecomputer.ru/os/unix/linux/linux.html"><span style=" font-family:'Ubuntu'; font-style:italic; text-decoration: underline; color:#0000ff;">Linux</span></a><span style=" font-family:'Ubuntu'; font-style:italic;"> </span><span style=" font-family:'Ubuntu';"><br /></span><img src="image1302134003.png" /><span style=" font-family:'Ubuntu';"> </span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Ubuntu'; font-size:13px; color:#737373;"><br /></p></td></tr></table></body></html>