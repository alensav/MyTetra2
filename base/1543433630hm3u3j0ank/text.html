<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:18px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="page_reader"></a><span style=" font-size:xx-large; font-weight:600;">С</span><span style=" font-size:xx-large; font-weight:600;">остояния файлов в гите / Системы контроля версий (GIT)</span> </p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style="" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://getpocket.com/redirect?url=https%3A%2F%2Fru.hexlet.io%2Fcourses%2Fintro_to_git%2Flessons%2Fgit-status%2Ftheory_unit&amp;formCheck=150cb685094f878748152aa1762f1477"><span style=" text-decoration: underline; color:#0000ff;">ru.hexlet.io</span></a> </li>
<li style="" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://getpocket.com/redirect?url=https%3A%2F%2Fru.hexlet.io%2Fcourses%2Fintro_to_git%2Flessons%2Fgit-status%2Ftheory_unit&amp;formCheck=150cb685094f878748152aa1762f1477"><span style=" text-decoration: underline; color:#0000ff;">View Original</span></a> </li>
<li style="" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://getpocket.com/a/queue/grid/mytetra"><span style=" text-decoration: underline; color:#0000ff;">mytetra</span></a> </li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Пред этим и последующими уроками обязательно нужно потренироваться с базовыми командами.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если посмотреть на вывод команды <span style=" font-family:'Courier New,courier';">git status</span> репозитория, в котором были сделаны все возможные изменения, такие как добавление нового файла, изменение и удаление, то он будет выглядеть примерно так:</p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">lasso$ git status</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">On branch master</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">Your branch is up-to-date with 'origin/master'.</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">Changes to be committed: # Изменения попадающие в следующий коммит</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">        new file:   .editorconfig</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">        modified:   Dockerfile</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">Changes not staged for commit: # Изменения которые не попадут в коммит</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">        modified:   docker-compose.yml</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">        deleted:    rebar.lock</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">Untracked files: # Неотслеживаемые файлы</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">        Procfile</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Не вдаваясь в детали можно сказать, что у любых файлов, с которыми мы работаем внутри рабочей копии, есть разные состояния. И именно им посвящен данный урок.</p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Untracked</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В первую очередь все файлы делятся на <span style=" font-family:'Courier New,courier';">tracked</span> и <span style=" font-family:'Courier New,courier';">untracked</span>. <span style=" font-family:'Courier New,courier';">Untracked</span> – это новый файл, который не был добавлен для отслеживания командой <span style=" font-family:'Courier New,courier';">git add</span>. Все остальные файлы являются <span style=" font-family:'Courier New,courier';">tracked</span>.</p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">lasso$ touch .editorconfig</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">lasso$ git status</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">On branch master</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">Your branch is up-to-date with 'origin/master'.</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">Untracked files: # Тут не отслеживается</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">        .editorconfig</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">lasso$ git add .editorconfig</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">lasso$ git status</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">On branch master</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">Your branch is up-to-date with 'origin/master'.</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">Changes to be committed: # Тут отслеживается</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">        new file:   .editorconfig</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">С непривычки такое поведение может показаться странным. Почему бы сразу не давать возможность коммитить, без необходимости добавлять файл в отслеживаемые?</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">На самом деле такое поведение очень важно. Как вы убедитесь в своей практике, множество инструментов генерирует свои файлы (например, редакторы, операционная система, пакетные менеджеры), а запуск программ порождает файлы с логами и другие артефакты. И если бы <span style=" font-family:'Courier New,courier';">git commit</span> автоматически включал все новые файлы, в репозиторий после коммитов постоянно попадали бы ненужные данные.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если вы заметили такие файлы, то их нужно добавить в специальный файл <span style=" font-family:'Courier New,courier';">.gitignore</span>, который поможет гиту определить то, что точно не придется коммитить. Больше вы эти файлы и папки не увидите даже после команды <span style=" font-family:'Courier New,courier';">git status</span>. Все, что перечислено в этом файле, закоммитить не удастся. Правда, если вы хотите добавить в <span style=" font-family:'Courier New,courier';">.gitignore</span> то что уже было закоммичено, предварительно придется удалить соответствующие данные из репозитория с помощью команды <span style=" font-family:'Courier New,courier';">git rm</span>.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Формат файла простой, его можно подсмотреть в одном из наших <a href="https://github.com/hexlet-boilerplates/nodejs-package/blob/master/.gitignore"><span style=" text-decoration: underline; color:#0000ff;">репозиториев</span></a>.</p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Tracked</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">С отслеживаемыми файлами все сложнее. Начнем с того, что они тоже могут находится в 3 разных состояниях:</p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style="" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">unmodified</li>
<li style="" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">modified</li>
<li style="" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">staged</li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">С unmodified все просто. Если файл в рабочей копии точно такой же как и в репозитории, то считается что его не модифицировали. Любой файл после коммита переходит в состояние unmodified. Соответственно, команда <span style=" font-family:'Courier New,courier';">git status</span> никак не отражает это состояние.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">Modified</span> тоже интуитивно понятен. Как только мы изменили любой <span style=" font-family:'Courier New,courier';">unmodified</span> (но не <span style=" font-family:'Courier New,courier';">untracked</span>!) файл, он автоматически становится <span style=" font-family:'Courier New,courier';">modified</span>. И вот тут нас поджидает сюрприз: если попробовать вызвать <span style=" font-family:'Courier New,courier';">git commit</span>, то <span style=" font-family:'Courier New,courier';">modified</span> файлы в него не попадут. Предварительно их нужно перевести в состояние <span style=" font-family:'Courier New,courier';">staged</span> сделав <span style=" font-family:'Courier New,courier';">git add</span>. В этом и заключается смысл команды <span style=" font-family:'Courier New,courier';">git add</span>, она переводит файлы с любым состоянием, кроме <span style=" font-family:'Courier New,courier';">unmodifed</span>, в состояние <span style=" font-family:'Courier New,courier';">staged</span>. Это касается и <span style=" font-family:'Courier New,courier';">untracked</span> файлов. И только после этого они попадут в коммит.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Я понимаю, что абзац выше может снести крышу, это нормально. Понимание состояний гита – это не то, что можно понять и простить исключительно по чтению мануалов. Единственное, что поможет – постоянная практика. Если сейчас вы поняли, что стало очень сложно – не отчаивайтесь, дочитайте до конца (<a href="https://ru.hexlet.io/blog/posts/how-to-read-books"><span style=" text-decoration: underline; color:#0000ff;">как мы рекомендуем</span></a>) и поэкспериментируйте. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">По большому счету наличие состояния <span style=" font-family:'Courier New,courier';">staged</span> не является критически необходимым, другими словами, можно было реализовать <span style=" font-family:'Courier New,courier';">git</span> и без этого промежуточного звена. Но сделан он не просто так, и его польза станет понятна только со временем. Главная идея в том, что во время работы над репозиторием, как правило, делаются несвязанные изменения в разных местах, например, вы делали какую-то фичу, а попутно отрефакторили код, который вам не понравился. Если этот код не имеет отношения к задаче, то, с точки зрения, понятия &quot;хороший коммит&quot; он должен быть закоммичен отдельно. Так вот, такое можно сделать именно благодаря наличию состояния <span style=" font-family:'Courier New,courier';">staged</span>. Делается это посредством интерактивного добавления <span style=" font-family:'Courier New,courier';">git add -i</span>, во время которого git показывает фрагменты измененного кода и спрашивает, нужно ли добавить это изменение в <span style=" font-family:'Courier New,courier';">staged</span> (или, как говорят, &quot;в индекс&quot;).</p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Reset</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Мы научились добавлять файлы в индекс, но что делать если мы наоборот хотим их удалить из него? Для этого нам помогут две команды: <span style=" font-family:'Courier New,courier';">reset</span> и <span style=" font-family:'Courier New,courier';">checkout</span>.</p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style="" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">git reset path/to/file</span> переводит файл из состояния <span style=" font-family:'Courier New,courier';">staged</span> в <span style=" font-family:'Courier New,courier';">modified</span></li>
<li style="" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">git checkout path/to/file</span> переводит файл из состояния <span style=" font-family:'Courier New,courier';">modified</span> в <span style=" font-family:'Courier New,courier';">unmodified</span>, то есть по сути эта команда сбрасывает изменения. </li></ul></body></html>